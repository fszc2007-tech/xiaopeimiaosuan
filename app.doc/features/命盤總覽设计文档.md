# 命盤總覽设计文档

## 页面概述

### 页面名称
命盤總覽 / Chart Overview Tab / 命盤总览

### 页面定位
- **页面类型**: 命盤详情页的子 Tab
- **用户类型**: 所有用户
- **页面层级**: 命盤详情页的第二个 Tab
- **访问条件**: 用户完成排盤后进入

### 页面目的
展示命盤的高階指標和標籤，包括命局體質、結構格局、體用喜忌、做功流通、宮位六親、行運概況等。**只展示指標和標籤，不提供長篇解讀**。點擊任意卡片可**一鍵解讀**，直接跳轉到聊天頁面並自動發送問題，立即獲得 LLM 的專項解讀。同時保留手動輸入入口，兩個功能共存。

### 角色定位
- **基本信息頁**：只放「原始資料」——出生時間、干支、藏干、五行統計等
- **命盤總覽頁**：只放「高階指標 & 標籤」，不長篇解讀
- **解讀**：全部交給 LLM 在聊天裡完成，命盤總覽只提供可點擊的指標

---

## 功能需求

### 2.1 核心功能

#### 2.1.1 四柱總表展示
- 展示完整的四柱表格（年月日時）
- 包含主星、天干、地支、藏干、副星、納音、星運、自坐、空亡、神煞等

#### 2.1.2 命局體質展示
- 展示日主強弱、氣候類型、五行摘要、動態程度

#### 2.1.3 結構格局展示
- 展示清濁程度、格局等級、格局類型、沖合風格

#### 2.1.4 體用喜忌展示
- 展示用神、忌神、體用結構

#### 2.1.5 做功流通展示
- 展示做功效率、主要流通鏈路

#### 2.1.6 宮位六親展示
- 展示財帛、事業、婚姻宮位狀態
- 展示關鍵人物

#### 2.1.7 行運概況展示
- 展示當前大運相性
- 展示未來 10 年主題

#### 2.1.8 關鍵標籤展示
- 展示格局、神煞、特殊體質等標籤

#### 2.1.9 一鍵解讀功能
- 每個卡片綁定一個 `sectionKey` 和 `defaultQuestion`
- 點擊卡片直接跳轉到聊天頁面
- **自動發送問題**，立即獲得 LLM 解讀結果（無需用戶再點發送）
- 問題自動填充到輸入框，用戶可看到問了什麼，方便繼續追問
- 保留手動輸入入口，兩個功能共存

#### 2.1.10 手動輸入功能
- 聊天頁面保留完整的輸入框
- 用戶可以手動輸入任何問題
- 支持追問和深入討論

---

## 页面设计

### 3.1 整体布局

页面采用垂直滚动布局（ScrollView），整体背景为纯白色。从上到下依次包含以下区块：

1. 四柱總表卡片（必须，默认展开）
2. 命局體質卡（默认展开）
3. 結構 & 格局卡（默认展开）
4. 體用 & 喜忌卡（可收起）
5. 做功 & 流通卡（可收起）
6. 宮位 & 六親概況卡（可收起）
7. 行運概況卡（可收起）
8. 關鍵標籤區（默认展开）

---

### 3.2 顶部 Tab 结构

**Tab 结构**:
- 固定 3 个 Tab：
  - `basicInfo` - 基本信息
  - `chartOverview` - 命盤總覽（当前页面）
  - `luckTimeline` - 大運流年

**Tab 样式**:
- 背景: `colors.bg`（白色）
- 选中 Tab 文字颜色: `colors.ink`
- 未选中 Tab 文字颜色: `colors.textSecondary`
- 选中 Tab 底部高亮条: `colors.brandBlue`，高度 2px
- Tab 之间间距: `spacing.md`

---

### 3.3 详细区块设计

#### 3.3.1 四柱總表卡片（Base Chart Card）

**位置**: 页面最顶部（Tab 下方）

**卡片样式**:
- 背景: `colors.cardBg`（白色）
- 圆角: `radius.lg`
- 边框: `colors.border`（细线）
- 阴影: `shadows.card`
- 内边距: `spacing.lg`
- 上下间距: `spacing.lg`
- **默认展开**，不可收起

**顶部信息**:
- 性别标识（圆形图标）
- 公曆日期时间
- 農曆日期时间
- 真太陽時（如有）
- 只显示，不解释

**表格结构**:

**列标题**（横向）:
- 日期（行标题列）
- 年柱
- 月柱
- 日柱
- 时柱

**行标题**（纵向）:
- 主星
- 天干
- 地支
- 藏干
- 副星
- 納音
- 星運
- 自坐
- 空亡
- 神煞

**表格样式**:
- 表头背景: `colors.disabledBg`（浅灰色）
- 表头文字: `colors.ink`，`fontWeights.semibold`
- 单元格边框: `colors.border`（1px）
- 单元格内边距: `spacing.sm`
- 行高: 自适应
- 文字大小: `fontSizes.sm`
- 文字颜色: `colors.ink`

**特殊样式**:
- 日柱行（主星为「元男」/「元女」）: 背景色 `colors.blueSoftBg`（浅蓝色高亮）
- 神煞单元格: 文字较小，可换行显示
- 藏干单元格: 多个藏干用「、」分隔

**数据结构**:
```typescript
interface BaziBaseChart {
  gender: 'male' | 'female';
  gregorian: string;
  lunar: string;
  trueSolar?: string;
  pillars: {
    year: PillarData;
    month: PillarData;
    day: PillarData;
    hour: PillarData;
  };
}

interface PillarData {
  mainStar: string;        // 主星
  heavenlyStem: string;    // 天干
  earthlyBranch: string;   // 地支
  hiddenStems: string[];   // 藏干数组
  auxiliaryStars: string[]; // 副星数组
  naYin: string;           // 納音
  starLuck: string;        // 星運
  selfSitting: string;     // 自坐
  emptiness: string;       // 空亡
  shenSha: string[];       // 神煞数组
}
```

> 注意：這張表在 **基本信息頁** 和 **命盤總覽頁** 可以共用同一個組件。

---

#### 3.3.2 命局體質卡（Body Constitution Card）

**位置**: 四柱總表下方

**卡片样式**:
- 背景: `colors.cardBg`（白色）
- 圆角: `radius.lg`
- 边框: `colors.border`（细线）
- 阴影: `shadows.card`
- 内边距: `spacing.lg`
- 上下间距: `spacing.lg`
- **默认展开**

**标题**:
- 文案: 「命局體質」
- 字体大小: `fontSizes.lg`
- 字体粗细: `fontWeights.semibold`
- 文字颜色: `colors.ink`
- 底部间距: `spacing.md`

**内容展示**:

**Tag 列表**（水平排列，可换行）:

```
┌─────────────────────────────────────────┐
│ 命局體質                                │
├─────────────────────────────────────────┤
│                                         │
│  [日主：稍弱]  [局象：偏寒]            │
│  [五行：水金偏重，火土偏弱]            │
│  [起伏感：較多變]                      │
│                                         │
└─────────────────────────────────────────┘
```

**Tag 样式**:
- 背景: `colors.blueSoftBg`（浅蓝色）或 `colors.greenSoftBg`（浅绿色）
- 文字颜色: `colors.ink`
- 圆角: `radius.pill`
- 内边距: 左右 `spacing.md`，上下 `spacing.xs`
- 字体大小: `fontSizes.sm`
- Tag 之间间距: `spacing.sm`

**Tag 内容**:
1. **日主強弱**: 「日主：{{level}}」
   - level 映射: `weak` → 「弱」, `slightly_weak` → 「稍弱」, `balanced` → 「平衡」, `slightly_strong` → 「稍強」, `strong` → 「強」

2. **局象氣候**: 「局象：{{climate}}」
   - climate 映射: `cold` → 「偏寒」, `hot` → 「偏熱」, `dry` → 「偏燥」, `wet` → 「偏濕」, `neutral` → 「中和」

3. **五行摘要**: 「五行：{{text}}」
   - 直接显示 `fiveElementSummary.text`

4. **動態程度**: 「起伏感：{{dynamic}}」
   - dynamic 映射: `static` → 「較穩定」, `medium` → 「中等」, `dynamic` → 「較多變」

**交互**:
- 點擊整張卡片或單個 Tag → 一鍵解讀
- `sectionKey`: `'body'`
- `defaultQuestion`: `'幫我解讀一下這張命盤的整體體質、起伏感。'`
- 觸發跳轉到聊天頁面，自動發送問題，立即獲得解讀結果

**数据结构**:
```typescript
interface BodyConstitutionData {
  dayMasterStrengthLevel: 'weak' | 'slightly_weak' | 'balanced' | 'slightly_strong' | 'strong';
  climateType: 'cold' | 'hot' | 'dry' | 'wet' | 'neutral';
  fiveElementSummary: {
    text: string;                // 如「水金偏重，火土偏弱」
    dominant: ('wood' | 'fire' | 'earth' | 'metal' | 'water')[];
    weak: ('wood' | 'fire' | 'earth' | 'metal' | 'water')[];
  };
  dynamicLevel: 'static' | 'medium' | 'dynamic';
}
```

---

#### 3.3.3 結構 & 格局卡（Structure & Pattern Card）

**位置**: 命局體質卡下方

**卡片样式**:
- 背景: `colors.cardBg`（白色）
- 圆角: `radius.lg`
- 边框: `colors.border`（细线）
- 阴影: `shadows.card`
- 内边距: `spacing.lg`
- 上下间距: `spacing.lg`
- **默认展开**

**标题**:
- 文案: 「結構 & 格局」
- 字体大小: `fontSizes.lg`
- 字体粗细: `fontWeights.semibold`
- 文字颜色: `colors.ink`
- 底部间距: `spacing.md`

**内容展示**:

**Tag 列表**（水平排列，可换行）:

```
┌─────────────────────────────────────────┐
│ 結構 & 格局                             │
├─────────────────────────────────────────┤
│                                         │
│  [結構：雜而有主]  [可發揮度：中上]    │
│  [局勢：沖合並見]                      │
│  [格局提示：偏印參與多]                │
│                                         │
└─────────────────────────────────────────┘
```

**Tag 样式**: 与命局體質卡相同

**Tag 内容**:
1. **結構清濁**: 「結構：{{qingzhuo}}」
   - qingzhuo 映射: `clear` → 「清」, `slightly_turbid` → 「略濁」, `mixed_with_core` → 「雜而有主」, `turbid` → 「濁」

2. **格局等級**: 「可發揮度：{{grade}}」
   - grade 映射: `high` → 「高」, `mid_high` → 「中上」, `mid` → 「中」, `mid_low` → 「中下」, `low` → 「低」

3. **格局類型**: 「格局提示：{{patternTypeLabel}}」
   - 直接显示 `patternTypeLabel`

4. **沖合風格**: 「局勢：{{style}}」
   - style 映射: `more_harmony` → 「偏合」, `more_conflict` → 「偏沖」, `mixed` → 「沖合並見」

**交互**:
- 點擊整張卡片 → 一鍵解讀
- `sectionKey`: `'pattern'`
- `defaultQuestion`: `'幫我解讀一下這張命盤的結構和格局，清濁程度如何？'`
- 觸發跳轉到聊天頁面，自動發送問題，立即獲得解讀結果

**数据结构**:
```typescript
interface StructurePatternData {
  qingzhuoLevel: 'clear' | 'slightly_turbid' | 'mixed_with_core' | 'turbid';
  patternGrade: 'high' | 'mid_high' | 'mid' | 'mid_low' | 'low';
  patternTypeLabel: string;      // 如「偏印重心格局」「比劫參與多」
  conflictHarmonyStyle: 'more_harmony' | 'more_conflict' | 'mixed';
}
```

---

#### 3.3.4 體用 & 喜忌卡（Body Use & Preferences Card）

**位置**: 結構 & 格局卡下方

**卡片样式**:
- 背景: `colors.cardBg`（白色）
- 圆角: `radius.lg`
- 边框: `colors.border`（细线）
- 阴影: `shadows.card`
- 内边距: `spacing.lg`
- 上下间距: `spacing.lg`
- **可收起**（Accordion）

**标题区域**:
- 标题: 「體用 & 喜忌」
- 右侧显示折叠/展开图标
- 点击标题区域可折叠/展开

**内容展示**（展开时）:

```
┌─────────────────────────────────────────┐
│ 體用 & 喜忌                    [展开/收起]│
├─────────────────────────────────────────┤
│                                         │
│  用神：火、土（正財、七殺）            │
│  忌神：水、金（比肩、偏印）            │
│                                         │
│  體系：身 / 印                          │
│  發力方向：財 / 官                      │
│                                         │
└─────────────────────────────────────────┘
```

**样式设计**:

1. **用神区域**:
   - 标签: 「用神：」
   - 五行显示: 使用彩色圆点或小图标标识五行
   - 十神显示: 「（正財、七殺）」
   - 背景: `colors.greenSoftBg`（浅绿色，表示有利）
   - 内边距: `spacing.md`
   - 圆角: `radius.md`
   - 底部间距: `spacing.sm`

2. **忌神区域**:
   - 标签: 「忌神：」
   - 五行显示: 使用彩色圆点或小图标标识五行
   - 十神显示: 「（比肩、偏印）」
   - 背景: `colors.orangeSoftBg`（浅橙色，表示不利）
   - 内边距: `spacing.md`
   - 圆角: `radius.md`
   - 底部间距: `spacing.md`

3. **體用結構**:
   - 行 1: 「體系：{{body}}」
     - body 显示 `mainRolesSummary.body` 数组，用「/」分隔
   - 行 2: 「發力方向：{{use}}」
     - use 显示 `mainRolesSummary.use` 数组，用「/」分隔
   - 字体大小: `fontSizes.base`
   - 文字颜色: `colors.ink`
   - 行间距: `spacing.xs`

**五行标识**:
- 使用小圆点或图标标识五行
- 颜色与五行分佈一致：
  - 金: 金色或橙色
  - 木: 绿色
  - 水: 蓝色
  - 火: 红色或橙色
  - 土: 棕色或灰色

**交互**:
- 點擊整張卡片或某一區塊 → 一鍵解讀
- `sectionKey`: `'useful_god'`
- `defaultQuestion`: `'幫我講講這盤的用神、忌神分別代表什麼影響？'`
- 觸發跳轉到聊天頁面，自動發送問題，立即獲得解讀結果

**数据结构**:
```typescript
interface BodyUsePreferencesData {
  usefulGodFinal: {
    elements: ('wood' | 'fire' | 'earth' | 'metal' | 'water')[];
    tenGods: string[];          // 如 ['正財', '七殺']
  };
  harmfulGodMajor: {
    elements: ('wood' | 'fire' | 'earth' | 'metal' | 'water')[];
    tenGods: string[];          // 如 ['比肩', '偏印']
  };
  mainRolesSummary: {
    body: string[];             // 體神十神列表，如 ['比肩', '正印']
    use: string[];              // 用神十神列表，如 ['正財', '七殺']
    help: string[];             // 助神十神列表
    taboo: string[];            // 忌神十神列表
  };
}
```

---

#### 3.3.5 做功 & 流通卡（Action & Flow Card）

**位置**: 體用 & 喜忌卡下方

**卡片样式**:
- 背景: `colors.cardBg`（白色）
- 圆角: `radius.lg`
- 边框: `colors.border`（细线）
- 阴影: `shadows.card`
- 内边距: `spacing.lg`
- 上下间距: `spacing.lg`
- **可收起**（Accordion）

**标题区域**:
- 标题: 「做功 & 流通」
- 右侧显示折叠/展开图标

**内容展示**（展开时）:

```
┌─────────────────────────────────────────┐
│ 做功 & 流通                   [展开/收起]│
├─────────────────────────────────────────┤
│                                         │
│  努力轉化率：中                         │
│                                         │
│  主要流通鏈路：                         │
│  [印] → [身] → [食] → [財] → [官]     │
│                                         │
└─────────────────────────────────────────┘
```

**样式设计**:

1. **效率指标**:
   - 标签: 「努力轉化率：」
   - 等级显示: 根据 `actionEfficiencyLevel` 显示
     - `low` → 「低」
     - `medium` → 「中」
     - `high` → 「高」
   - 可配合小图标或颜色标识
   - 字体大小: `fontSizes.base`
   - 字体粗细: `fontWeights.medium`
   - 文字颜色: `colors.ink`
   - 底部间距: `spacing.md`

2. **流通鏈路图**:
   - 标签: 「主要流通鏈路：」
   - 鏈路展示: 使用箭头连接各个节点
   - 节点样式:
     - 背景: `colors.blueSoftBg`（浅蓝色）
     - 文字颜色: `colors.ink`
     - 圆角: `radius.md`
     - 内边距: 左右 `spacing.sm`，上下 `spacing.xs`
     - 字体大小: `fontSizes.sm`
   - 箭头: 使用 `→` 符号或箭头图标
   - 箭头颜色: `colors.textSecondary`
   - 整体居中显示

**可视化方案**:

**方案一：水平链式图**
```
[印] → [身] → [食] → [財] → [官]
```

**方案二：流程图样式**（更美观）
```
    ┌───┐     ┌───┐     ┌───┐     ┌───┐     ┌───┐
    │ 印 │ ──→ │ 身 │ ──→ │ 食 │ ──→ │ 財 │ ──→ │ 官 │
    └───┘     └───┘     └───┘     └───┘     └───┘
```

**交互**:
- 點擊整張卡片 → 一鍵解讀
- `sectionKey`: `'action_chain'`
- `defaultQuestion`: `'幫我解讀一下這盤的做功和流通鏈路，轉化效率如何？'`
- 觸發跳轉到聊天頁面，自動發送問題，立即獲得解讀結果

**数据结构**:
```typescript
interface ActionFlowData {
  actionEfficiencyLevel: 'low' | 'medium' | 'high';
  mainActionChainLabel: string;  // 顯示用，如「印 → 身 → 食 → 財 → 官」
}
```

---

#### 3.3.6 宮位 & 六親概況卡（Palace & Relationships Card）

**位置**: 做功 & 流通卡下方

**卡片样式**:
- 背景: `colors.cardBg`（白色）
- 圆角: `radius.lg`
- 边框: `colors.border`（细线）
- 阴影: `shadows.card`
- 内边距: `spacing.lg`
- 上下间距: `spacing.lg`
- **可收起**（Accordion）

**标题区域**:
- 标题: 「宮位 & 六親」
- 右侧显示折叠/展开图标

**内容展示**（展开时）:

```
┌─────────────────────────────────────────┐
│ 宮位 & 六親                   [展开/收起]│
├─────────────────────────────────────────┤
│                                         │
│  ┌────────┐  ┌────────┐  ┌────────┐   │
│  │ 財帛   │  │ 事業   │  │ 婚姻   │   │
│  │ 偏有利 │  │ 中性   │  │ 略有壓力│   │
│  │  [✓]   │  │  [○]   │  │  [!]   │   │
│  └────────┘  └────────┘  └────────┘   │
│                                         │
│  人生關鍵人物：配偶、父母               │
│                                         │
└─────────────────────────────────────────┘
```

**样式设计**:

1. **宮位状态卡片**（三列布局）:
   - 每个宮位一个卡片
   - 卡片样式:
     - 背景: 根据状态使用不同颜色
       - `good` → `colors.greenSoftBg`（浅绿色）
       - `neutral` → `colors.disabledBg`（浅灰色）
       - `stress` → `colors.orangeSoftBg`（浅橙色）
     - 边框: `colors.border`（1px）
     - 圆角: `radius.md`
     - 内边距: `spacing.md`
     - 最小高度: 80px
   
   - 卡片内容:
     - 宮位名称: 「財帛」「事業」「婚姻」
       - 字体大小: `fontSizes.base`
       - 字体粗细: `fontWeights.semibold`
       - 文字颜色: `colors.ink`
     - 状态文字:
       - `good` → 「偏有利」
       - `neutral` → 「中性」
       - `stress` → 「略有壓力」
       - 字体大小: `fontSizes.sm`
       - 文字颜色: `colors.ink`
     - 状态图标（可选）:
       - `good` → ✓（绿色）
       - `neutral` → ○（灰色）
       - `stress` → !（橙色）

2. **關鍵人物**:
   - 标签: 「人生關鍵人物：」
   - 人物列表: 显示 `keyPersons` 数组，用「、」分隔
   - 人物映射:
     - `parents` → 「父母」
     - `partner` → 「配偶」
     - `children` → 「子女」
     - `siblings` → 「兄弟」
     - `mentor` → 「師長」
     - `self` → 「自己」
   - 字体大小: `fontSizes.base`
   - 文字颜色: `colors.ink`
   - 顶部间距: `spacing.md`

**布局**:
- 三列宮位卡片水平排列
- 卡片之间间距: `spacing.md`
- 關鍵人物显示在下方

**交互**:
- 點擊「財帛」卡片 → 一鍵解讀
  - `sectionKey`: `'palace'`
  - `defaultQuestion`: `'大概說說財、事業、感情三個宮位各是什麼傾向？'`
- 點擊「事業」卡片 → 一鍵解讀（同上）
- 點擊「婚姻」卡片 → 一鍵解讀（同上）
- 點擊整張卡片 → 一鍵解讀（同上）
- 觸發跳轉到聊天頁面，自動發送問題，立即獲得解讀結果

**数据结构**:
```typescript
interface PalaceRelationshipsData {
  palacesStatusSummary: {
    wealth: 'good' | 'neutral' | 'stress';
    career: 'good' | 'neutral' | 'stress';
    marriage: 'good' | 'neutral' | 'stress';
  };
  keyPersons: ('parents' | 'partner' | 'children' | 'siblings' | 'mentor' | 'self')[];
}
```

---

#### 3.3.7 行運概況卡（Luck Overview Card）

**位置**: 宮位 & 六親概況卡下方

**卡片样式**:
- 背景: `colors.cardBg`（白色）
- 圆角: `radius.lg`
- 边框: `colors.border`（细线）
- 阴影: `shadows.card`
- 内边距: `spacing.lg`
- 上下间距: `spacing.lg`
- **可收起**（Accordion）

**标题区域**:
- 标题: 「當前 & 未來運勢」
- 右侧显示折叠/展开图标

**内容展示**（展开时）:

```
┌─────────────────────────────────────────┐
│ 當前 & 未來運勢               [展开/收起]│
├─────────────────────────────────────────┤
│                                         │
│  當前大運：壓力中帶機會  [⚖]           │
│                                         │
│  未來 10 年主題：                       │
│  [事業]  [財富]                        │
│                                         │
│  [查看大運詳情] →                      │
│                                         │
└─────────────────────────────────────────┘
```

**样式设计**:

1. **當前大運**:
   - 标签: 「當前大運：」
   - 状态文字: 显示 `currentLuckLabel`
   - 状态图标:
     - `good` → ↑（向上箭头，绿色）
     - `neutral` → ⚖（天平，灰色）
     - `stress` → ↓（向下箭头，橙色）
   - 状态颜色:
     - `good` → `colors.brandGreen`（绿色）
     - `neutral` → `colors.textSecondary`（灰色）
     - `stress` → `colors.brandOrange`（橙色）
   - 字体大小: `fontSizes.base`
   - 字体粗细: `fontWeights.medium`
   - 文字颜色: `colors.ink`
   - 底部间距: `spacing.md`

2. **未來 10 年主題**:
   - 标签: 「未來 10 年主題：」
   - 主题 Tag 列表: 显示 `nextDecadeTheme` 数组
   - Tag 样式:
     - 背景: `colors.blueSoftBg`（浅蓝色）
     - 文字颜色: `colors.ink`
     - 圆角: `radius.pill`
     - 内边距: 左右 `spacing.md`，上下 `spacing.xs`
     - 字体大小: `fontSizes.sm`
     - Tag 之间间距: `spacing.sm`
   - 水平排列，可换行
   - 顶部间距: `spacing.sm`

3. **查看詳情按鈕**（可选）:
   - 文案: 「查看大運詳情」
   - 按钮类型: `GhostButton`（文字按钮）
   - 文字颜色: `colors.brandBlue`
   - 字体大小: `fontSizes.sm`
   - 右侧显示箭头图标 →
   - 点击行为: 跳转到「大運流年」Tab
   - 顶部间距: `spacing.md`

**交互**:
- 點擊整張卡片 → 一鍵解讀
  - `sectionKey`: `'luck'`
  - `defaultQuestion`: `'我現在這步大運算好嗎？未來大方向是偏財還是偏事業？'`
  - 觸發跳轉到聊天頁面，自動發送問題，立即獲得解讀結果
- 點擊「查看大運詳情」按鈕 → 跳转到「大運流年」Tab

**数据结构**:
```typescript
interface LuckOverviewData {
  currentLuckCompat: 'good' | 'neutral' | 'stress';
  currentLuckLabel: string;      // 短語，如「壓力中帶機會」「偏順」
  nextDecadeTheme: string[];     // 如 ['財富', '事業']
}
```

---

#### 3.3.8 關鍵標籤區（Key Tags Section）

**位置**: 行運概況卡下方（最后一个区块）

**卡片样式**:
- 背景: `colors.cardBg`（白色）
- 圆角: `radius.lg`
- 边框: `colors.border`（细线）
- 阴影: `shadows.card`
- 内边距: `spacing.lg`
- 上下间距: `spacing.lg`
- 底部间距: `spacing.xl`（最后一个区块）
- **默认展开**

**标题**:
- 文案: 「關鍵標籤」
- 字体大小: `fontSizes.lg`
- 字体粗细: `fontWeights.semibold`
- 文字颜色: `colors.ink`
- 底部间距: `spacing.md`

**内容展示**:

**Tag 列表**（水平排列，可换行）:

```
┌─────────────────────────────────────────┐
│ 關鍵標籤                                │
├─────────────────────────────────────────┤
│                                         │
│  [偏印較重]  [動象命]  [帶祿神]        │
│  [桃花星]  [文昌星]  [天乙貴人]        │
│                                         │
└─────────────────────────────────────────┘
```

**Tag 样式**:
- 背景: `colors.greenSoftBg`（浅绿色）或 `colors.blueSoftBg`（浅蓝色）
- 文字颜色: `colors.ink`
- 圆角: `radius.pill`
- 内边距: 左右 `spacing.md`，上下 `spacing.xs`
- 字体大小: `fontSizes.sm`
- Tag 之间间距: `spacing.sm`
- 水平排列，自动换行

**特殊標籤样式**（可选）:
- 格局類標籤: 使用 `colors.blueSoftBg`（浅蓝色）
- 神煞類標籤: 使用 `colors.greenSoftBg`（浅绿色）
- 特殊體質標籤: 使用 `colors.orangeSoftBg`（浅橙色）

**交互**:
- 點擊任一 Tag → 一鍵解讀
  - `sectionKey`: `'tag'`
  - `defaultQuestion`: `'幫我解讀一下${tagText}，這個標籤對我的命盤有什麼影響？'`
  - 觸發跳轉到聊天頁面，自動發送問題，立即獲得解讀結果

**数据结构**:
```typescript
interface KeyTagsData {
  keyTags: string[];             // 如 ['偏印較重', '動象命', '帶祿神', '桃花星']
}
```

---

### 3.4 整体风格要求

#### 3.4.1 背景与布局
- **整体背景**: 纯白色（`colors.bg`）
- **内容区域**: 使用 `ScrollView` 包裹，支持垂直滚动
- **安全区域**: 使用 `SafeAreaView` 包裹，避免顶部遮挡
- **页面内边距**: 左右 `spacing.lg`

#### 3.4.2 卡片样式
- **背景**: 白色（`colors.cardBg`）
- **圆角**: `radius.lg`（12px）
- **边框**: `colors.border`（细线，1px）
- **阴影**: `shadows.card`（轻微阴影）
- **内边距**: `spacing.lg`（24px）
- **卡片间距**: `spacing.lg`（24px）

#### 3.4.3 折叠卡片（Accordion）
- **展开/收起动画**: 平滑过渡
- **图标**: 使用箭头图标，展开时向下，收起时向右
- **点击区域**: 整个标题区域可点击

#### 3.4.4 文字颜色
- **主标题**: `colors.ink`（#32343a）
- **副标题/说明文字**: `colors.textSecondary`（#6b7280）
- **重点数据**: `colors.brandBlue`（#648e93）

#### 3.4.5 Tag 样式
- **普通 Tag**: `colors.blueSoftBg` 或 `colors.greenSoftBg` 背景
- **有利 Tag**: `colors.greenSoftBg`（绿色）
- **不利 Tag**: `colors.orangeSoftBg`（橙色）
- **中性 Tag**: `colors.disabledBg`（灰色）

---

## 数据需求

### 4.1 总数据接口

```typescript
// 命盤總覽的主數據結構
export interface BaziOverview {
  // 0. 四柱原始盤（可複用已有類型）
  baseChart: BaziBaseChart; // 年月日時干支、藏干、十神等，供上方四柱卡片使用

  // 1. 命局體質類
  dayMasterStrengthLevel: 'weak' | 'slightly_weak' | 'balanced' | 'slightly_strong' | 'strong';
  climateType: 'cold' | 'hot' | 'dry' | 'wet' | 'neutral';
  fiveElementSummary: {
    text: string;                // 如「水金偏重，火土偏弱」
    dominant: ('wood' | 'fire' | 'earth' | 'metal' | 'water')[];
    weak: ('wood' | 'fire' | 'earth' | 'metal' | 'water')[];
  };
  dynamicLevel: 'static' | 'medium' | 'dynamic';

  // 2. 清濁 / 結構純度類
  qingzhuoLevel: 'clear' | 'slightly_turbid' | 'mixed_with_core' | 'turbid';
  patternGrade: 'high' | 'mid_high' | 'mid' | 'mid_low' | 'low';
  patternTypeLabel: string;      // 如「偏印重心格局」「比劫參與多」
  conflictHarmonyStyle: 'more_harmony' | 'more_conflict' | 'mixed';

  // 3. 體用 / 喜忌結構
  usefulGodFinal: {
    elements: ('wood' | 'fire' | 'earth' | 'metal' | 'water')[];
    tenGods: string[];          // 如 ['正財', '七殺']
  };
  harmfulGodMajor: {
    elements: ('wood' | 'fire' | 'earth' | 'metal' | 'water')[];
    tenGods: string[];          // 如 ['比肩', '偏印']
  };
  mainRolesSummary: {
    body: string[];             // 體神十神列表，如 ['比肩', '正印']
    use: string[];              // 用神十神列表，如 ['正財', '七殺']
    help: string[];             // 助神十神列表
    taboo: string[];            // 忌神十神列表
  };

  // 4. 做功 / 流通鏈路
  actionEfficiencyLevel: 'low' | 'medium' | 'high';
  mainActionChainLabel: string;  // 顯示用，如「印 → 身 → 食 → 財 → 官」

  // 5. 宮位 / 六親摘要
  palacesStatusSummary: {
    wealth: 'good' | 'neutral' | 'stress';
    career: 'good' | 'neutral' | 'stress';
    marriage: 'good' | 'neutral' | 'stress';
  };
  keyPersons: ('parents' | 'partner' | 'children' | 'siblings' | 'mentor' | 'self')[];

  // 6. 行運相容度
  currentLuckCompat: 'good' | 'neutral' | 'stress';
  currentLuckLabel: string;      // 短語，如「壓力中帶機會」「偏順」
  nextDecadeTheme: string[];     // 如 ['財富', '事業']

  // 7. 關鍵標籤（格局 / 神煞 / 特殊體質）
  keyTags: string[];             // 如 ['偏印較重', '動象命', '帶祿神', '桃花星']
}
```

### 4.2 数据说明

- **這個結構只存「結果」**，不存原始計算過程
- 清濁、做功、體用的細節計算可以放在引擎內部，或另外開一個 `BaziOverviewInternal` 給 LLM，不必在前端用
- 前端只需按照上述字段渲染
- 若某個區塊對應字段為 `null/undefined`，可整塊隱藏
- 所有数据由后端 API 提供（八字引擎计算）

---

## 交互流程

### 5.1 用户操作流程

1. **进入页面**
   - 用户完成排盤后，切换到「命盤總覽」Tab
   - 页面加载数据并展示

2. **浏览内容**
   - 用户垂直滚动查看各个区块
   - 查看四柱總表、命局體質、結構格局等信息

3. **折叠/展开卡片**
   - 点击可折叠卡片的标题区域
   - 卡片平滑展开或收起

4. **一鍵解讀（主要交互）**
   - 点击任意卡片或标签
   - **直接跳轉到聊天頁面**
   - **自動發送問題**，立即獲得 LLM 解讀結果
   - 問題自動填充到輸入框，用戶可看到問了什麼
   - 用戶可以繼續追問或手動輸入新問題

5. **手動輸入（輔助功能）**
   - 在聊天頁面，用戶可以手動輸入任何問題
   - 支持追問和深入討論
   - 兩個功能共存，互不干擾

6. **查看大運詳情**
   - 点击「查看大運詳情」按钮
   - 跳转到「大運流年」Tab

---

### 5.2 一鍵解讀詳細設計

#### 5.2.1 SectionKey 定義

每個卡片綁定一個 `sectionKey`，用於標識解讀的主題：

```typescript
type OverviewSectionKey =
  | 'body'          // 命局體質
  | 'pattern'       // 清濁 & 格局
  | 'useful_god'    // 體用 & 喜忌
  | 'action_chain'  // 做功 & 流通
  | 'palace'        // 宮位 & 六親
  | 'luck'          // 行運概況
  | 'tag';          // 關鍵標籤
```

#### 5.2.2 卡片配置接口

每個卡片定義一個配置對象：

```typescript
interface OverviewCardConfig {
  sectionKey: OverviewSectionKey;
  defaultQuestion: string; // 給 LLM 的「用戶問題」
}
```

#### 5.2.3 各卡片配置示例

| 卡片 | sectionKey | defaultQuestion |
|------|-----------|----------------|
| 命局體質卡 | `'body'` | `'幫我解讀一下這張命盤的整體體質、起伏感。'` |
| 結構 & 格局卡 | `'pattern'` | `'幫我解讀一下這張命盤的結構和格局，清濁程度如何？'` |
| 體用 & 喜忌卡 | `'useful_god'` | `'幫我講講這盤的用神、忌神分別代表什麼影響？'` |
| 做功 & 流通卡 | `'action_chain'` | `'幫我解讀一下這盤的做功和流通鏈路，轉化效率如何？'` |
| 宮位 & 六親卡 | `'palace'` | `'大概說說財、事業、感情三個宮位各是什麼傾向？'` |
| 行運概況卡 | `'luck'` | `'我現在這步大運算好嗎？未來大方向是偏財還是偏事業？'` |
| 關鍵標籤 | `'tag'` | `'幫我解讀一下${tagText}，這個標籤對我的命盤有什麼影響？'` |

#### 5.2.4 前端實現邏輯

**點擊卡片時**:

```typescript
const handleCardClick = (config: OverviewCardConfig) => {
  // 跳轉到聊天頁面，並傳遞參數
  navigation.navigate('Chat', {
    mode: 'fromOverview',
    sectionKey: config.sectionKey,
    seedQuestion: config.defaultQuestion,
    baziData: baziOverviewData, // 傳遞命盤數據
  });
};
```

**聊天頁面接收參數後**:

```typescript
// 在 ChatScreen 中
useEffect(() => {
  const { mode, sectionKey, seedQuestion, baziData } = route.params || {};
  
  if (mode === 'fromOverview' && seedQuestion) {
    // 1. 自動填充問題到輸入框（讓用戶看到問了什麼）
    setInputText(seedQuestion);
    
    // 2. 自動發送問題，立即獲得解讀
    handleSendMessage(seedQuestion, {
      sectionKey,
      baziData,
    });
  }
}, [route.params]);
```

#### 5.2.5 UX 細節

**點擊卡片後的流程**:

1. **跳轉到聊天頁面**
   - 平滑過渡動畫
   - 聊天頁面自動滾動到底部

2. **自動填充問題到輸入框**
   - 問題文字顯示在輸入框中
   - 用戶可以看到問了什麼
   - 輸入框處於可編輯狀態

3. **自動發送問題**
   - 立即調用 API 發送問題
   - 顯示加載狀態（打字動畫或加載指示器）

4. **顯示 LLM 解讀結果**
   - 解讀結果以消息氣泡形式顯示
   - 支持 Markdown 格式
   - 支持繼續追問

5. **用戶可以**:
   - 修改輸入框中的問題，重新發送
   - 直接追問：「那具體到感情怎麼樣？」
   - 手動輸入任何新問題

---

### 5.3 後端 / LLM Prompt 設計

#### 5.3.1 總體 Prompt 結構

後端不需要為每張卡寫一整份全新的 prompt，可以使用「一個總 prompt + sectionKey 分支」：

```
你是子平+盲派融合的命理轉述器。

現在用戶在「命盤總覽」中點擊了某一個卡片，希望針對該區域做解讀。

[上下文]
- base_chart: {...}         // 原始四柱
- bazi_overview: {...}      // Overview JSON 數據
- section: {{sectionKey}}   // 'body' | 'pattern' | 'useful_god' | ...

[任務]
- 只聚焦當前 section 對應的主題解讀，避免重複整體八字。
- 用 3~6 段話講清楚要點，語氣平實，避免嚇人。
- 留 1 個鉤子，引導用戶如果想深入某一領域，可以再追問。

然後回答用戶的問題：{{defaultQuestion}}
```

#### 5.3.2 SectionKey 分支邏輯

後端根據 `sectionKey` 做分支處理，優先用對應的數據字段：

**body（命局體質）**:
- 優先用: `dayMasterStrengthLevel`、`climateType`、`fiveElementSummary`、`dynamicLevel`
- 解讀重點: 日主強弱、氣候類型、五行分布、動態程度

**pattern（結構格局）**:
- 優先用: `qingzhuoLevel`、`patternGrade`、`patternTypeLabel`、`conflictHarmonyStyle`
- 解讀重點: 清濁程度、格局等級、格局類型、沖合風格

**useful_god（體用喜忌）**:
- 優先用: `usefulGodFinal`、`harmfulGodMajor`、`mainRolesSummary`
- 解讀重點: 用神、忌神、體用結構

**action_chain（做功流通）**:
- 優先用: `actionEfficiencyLevel`、`mainActionChainLabel`
- 解讀重點: 做功效率、流通鏈路

**palace（宮位六親）**:
- 優先用: `palacesStatusSummary`、`keyPersons`
- 解讀重點: 財帛、事業、婚姻宮位狀態，關鍵人物

**luck（行運概況）**:
- 優先用: `currentLuckCompat`、`currentLuckLabel`、`nextDecadeTheme`
- 解讀重點: 當前大運相性、未來主題

**tag（關鍵標籤）**:
- 優先用: `keyTags` 中對應的標籤
- 解讀重點: 該標籤的具體含義和影響

#### 5.3.3 後端實現示例（偽代碼）

```typescript
async function handleOverviewQuestion(
  sectionKey: OverviewSectionKey,
  defaultQuestion: string,
  baziData: BaziOverview
) {
  // 根據 sectionKey 選擇對應的數據字段
  let focusData = {};
  let focusFields: string[] = [];
  
  switch (sectionKey) {
    case 'body':
      focusData = {
        dayMasterStrengthLevel: baziData.dayMasterStrengthLevel,
        climateType: baziData.climateType,
        fiveElementSummary: baziData.fiveElementSummary,
        dynamicLevel: baziData.dynamicLevel,
      };
      focusFields = ['日主強弱', '氣候類型', '五行分布', '動態程度'];
      break;
      
    case 'pattern':
      focusData = {
        qingzhuoLevel: baziData.qingzhuoLevel,
        patternGrade: baziData.patternGrade,
        patternTypeLabel: baziData.patternTypeLabel,
        conflictHarmonyStyle: baziData.conflictHarmonyStyle,
      };
      focusFields = ['清濁程度', '格局等級', '格局類型', '沖合風格'];
      break;
      
    // ... 其他 case
  }
  
  // 構建 prompt
  const prompt = buildPrompt({
    baseChart: baziData.baseChart,
    baziOverview: baziData,
    section: sectionKey,
    focusData,
    focusFields,
    userQuestion: defaultQuestion,
  });
  
  // 調用 LLM
  const response = await callLLM(prompt);
  
  return response;
}
```

---

### 5.4 手動輸入功能

#### 5.4.1 功能說明
- 聊天頁面保留完整的輸入框
- 用戶可以手動輸入任何問題
- 支持追問和深入討論
- 與一鍵解讀功能共存，互不干擾

#### 5.4.2 使用場景
- 用戶想問一些卡片沒有覆蓋的問題
- 用戶想深入追問某個細節
- 用戶想修改自動填充的問題

#### 5.4.3 實現方式
- 輸入框始終可用
- 手動輸入的問題直接發送給 LLM
- LLM 可以訪問完整的命盤數據（`baseChart + baziOverview`）

---

### 5.5 折叠卡片交互

#### 5.5.1 交互細節
- 点击标题区域切换展开/收起状态
- 使用平滑动画过渡
- 图标旋转动画（展开时向下，收起时向右）

#### 5.5.2 默認狀態
- 四柱總表卡片：默认展开，不可收起
- 命局體質卡：默认展开
- 結構 & 格局卡：默认展开
- 其他卡片：默认收起（可展开）

---

## 与「基本信息」的区别

### 6.1 避免重复的规则

#### 6.1.1 基本信息頁 才顯示
- 出生時空、真太陽時計算開關
- 四柱原始盤所有細節（包括五行數值、真實神煞列表等）
- 任意計算過程相關的 raw data
- 五行統計數值
- 藏干詳細列表

#### 6.1.2 命盤總覽頁 只顯示
- `BaziOverview` 中的結果字段（level / label / tag）
- 高階指標和標籤
- 不再出現「真太陽時」「納音詳細列表」「具體神煞全表」這些內容
- 不再出現「五行統計數值」「藏干詳細列表」

#### 6.1.3 任何長段文字解讀
- 一律不放在命盤總覽
- 用「點擊卡片 → 拉起聊天」的方式交給 LLM 完成

### 6.2 四柱總表的共用

- 四柱總表卡片可以在「基本信息頁」和「命盤總覽頁」共用同一個組件
- 在命盤總覽頁中，四柱總表只显示表格，不显示「五行統計、真太陽時開關」等內容

---

## 技术实现（预留）

### 7.1 技术要点

- 页面滚动实现（ScrollView）
- 折叠卡片实现（Accordion）
- 表格组件实现（四柱總表）
- 标签组件实现
- **一鍵解讀功能**（點擊卡片自動發送問題）
- 聊天頁面自動填充和自動發送
- 手動輸入功能（與一鍵解讀共存）
- 数据加载和错误处理

### 7.2 相关文件结构

```
src/
├── screens/
│   └── Bazi/
│       ├── BaziScreen.tsx              # 命盤主页面
│       ├── ChartOverviewTab.tsx        # 命盤總覽 Tab
│       └── components/
│           ├── BaseChartCard.tsx       # 四柱總表卡片（可共用）
│           ├── BodyConstitutionCard.tsx # 命局體質卡片
│           ├── StructurePatternCard.tsx # 結構格局卡片
│           ├── BodyUseCard.tsx         # 體用喜忌卡片
│           ├── ActionFlowCard.tsx      # 做功流通卡片
│           ├── PalaceRelationsCard.tsx # 宮位六親卡片
│           ├── LuckOverviewCard.tsx    # 行運概況卡片
│           ├── KeyTagsCard.tsx         # 關鍵標籤卡片
│           └── AccordionCard.tsx       # 折叠卡片组件
├── services/
│   └── api/
│       └── baziService.ts              # 命盤 API
└── types/
    └── bazi.ts                         # 命盤类型定义
```

### 7.3 一鍵解讀實現

#### 7.3.1 卡片配置定義

```typescript
// 定義 sectionKey 類型
type OverviewSectionKey =
  | 'body'          // 命局體質
  | 'pattern'       // 清濁 & 格局
  | 'useful_god'    // 體用 & 喜忌
  | 'action_chain'  // 做功 & 流通
  | 'palace'        // 宮位 & 六親
  | 'luck'          // 行運概況
  | 'tag';          // 關鍵標籤

// 卡片配置接口
interface OverviewCardConfig {
  sectionKey: OverviewSectionKey;
  defaultQuestion: string; // 給 LLM 的「用戶問題」
}

// 各卡片配置
const cardConfigs: Record<string, OverviewCardConfig> = {
  body: {
    sectionKey: 'body',
    defaultQuestion: '幫我解讀一下這張命盤的整體體質、起伏感。',
  },
  pattern: {
    sectionKey: 'pattern',
    defaultQuestion: '幫我解讀一下這張命盤的結構和格局，清濁程度如何？',
  },
  useful_god: {
    sectionKey: 'useful_god',
    defaultQuestion: '幫我講講這盤的用神、忌神分別代表什麼影響？',
  },
  action_chain: {
    sectionKey: 'action_chain',
    defaultQuestion: '幫我解讀一下這盤的做功和流通鏈路，轉化效率如何？',
  },
  palace: {
    sectionKey: 'palace',
    defaultQuestion: '大概說說財、事業、感情三個宮位各是什麼傾向？',
  },
  luck: {
    sectionKey: 'luck',
    defaultQuestion: '我現在這步大運算好嗎？未來大方向是偏財還是偏事業？',
  },
};
```

#### 7.3.2 點擊卡片處理函數

```typescript
// 點擊卡片時調用
const handleCardClick = (config: OverviewCardConfig) => {
  // 跳轉到聊天頁面，並傳遞參數
  navigation.navigate('Chat', {
    mode: 'fromOverview',
    sectionKey: config.sectionKey,
    seedQuestion: config.defaultQuestion,
    baziData: baziOverviewData, // 傳遞命盤數據
  });
};

// 點擊標籤時調用
const handleTagClick = (tagText: string) => {
  navigation.navigate('Chat', {
    mode: 'fromOverview',
    sectionKey: 'tag',
    seedQuestion: `幫我解讀一下${tagText}，這個標籤對我的命盤有什麼影響？`,
    baziData: baziOverviewData,
    tagText: tagText,
  });
};
```

#### 7.3.3 聊天頁面接收參數

```typescript
// 在 ChatScreen 中
useEffect(() => {
  const { mode, sectionKey, seedQuestion, baziData } = route.params || {};
  
  if (mode === 'fromOverview' && seedQuestion) {
    // 1. 自動填充問題到輸入框（讓用戶看到問了什麼）
    setInputText(seedQuestion);
    
    // 2. 自動發送問題，立即獲得解讀
    handleSendMessage(seedQuestion, {
      sectionKey,
      baziData,
    });
  }
}, [route.params]);

// 發送消息函數
const handleSendMessage = async (
  message: string,
  context?: {
    sectionKey?: OverviewSectionKey;
    baziData?: BaziOverview;
  }
) => {
  // 顯示用戶消息
  addUserMessage(message);
  
  // 顯示加載狀態
  setLoading(true);
  
  try {
    // 調用 API
    const response = await baziService.askQuestion({
      question: message,
      sectionKey: context?.sectionKey,
      baziData: context?.baziData,
    });
    
    // 顯示 LLM 回覆
    addAssistantMessage(response.text);
  } catch (error) {
    // 錯誤處理
    addAssistantMessage('抱歉，解讀過程中出現錯誤，請稍後再試。');
  } finally {
    setLoading(false);
  }
};
```

#### 7.3.4 API 接口定義

```typescript
// baziService.ts
interface AskQuestionRequest {
  question: string;
  sectionKey?: OverviewSectionKey;
  baziData?: BaziOverview;
  tagText?: string;
}

interface AskQuestionResponse {
  text: string;
  sectionKey?: OverviewSectionKey;
}

export const baziService = {
  async askQuestion(request: AskQuestionRequest): Promise<AskQuestionResponse> {
    const response = await fetch('/api/bazi/ask', {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify(request),
    });
    return response.json();
  },
};
```

---

## 设计规范

### 8.1 视觉设计

- **遵循 UI_SPEC.md 中的设计规范**
- 使用 Design Tokens（colors, typography, layout）
- 整体背景为纯白色
- 卡片使用圆角、边框、阴影区分层级
- 保持充足的留白
- **美观第一**：注重视觉层次和色彩搭配

### 8.2 交互设计

- 页面滚动流畅
- 折叠动画平滑
- 点击反馈明确
- 跳转聊天流程顺畅

### 8.3 响应式设计

- 适配不同屏幕尺寸
- 内容在小屏设备上可正常滚动
- 表格在小屏上支持横向滚动（如需要）
- Tag 列表自动换行

---

## 可视化设计说明

### 9.1 四柱總表设计

**设计要点**:
- 清晰的表格结构
- 日柱行高亮显示（浅蓝色背景）
- 神煞单元格支持多行显示
- 藏干用「、」分隔，清晰易读

### 9.2 命局體質可视化

**设计要点**:
- 使用 Tag 列表展示，直观清晰
- 不同指标使用不同颜色的 Tag
- 水平排列，自动换行

### 9.3 結構格局可视化

**设计要点**:
- Tag 列表展示
- 清濁程度可用颜色深浅表示
- 格局等級可用星级或进度条表示（可选）

### 9.4 體用喜忌可视化

**设计要点**:
- 用神和忌神使用对比鲜明的背景色
- 五行使用彩色圆点或图标标识
- 體用結構用简洁的文字列表展示

### 9.5 做功流通可视化

**设计要点**:
- 流通鏈路使用箭头连接，清晰展示流向
- 节点使用卡片样式，易于识别
- 效率等级用文字和颜色标识

### 9.6 宮位六親可视化

**设计要点**:
- 三个宮位卡片并排显示，一目了然
- 使用颜色标识状态（绿色=有利，灰色=中性，橙色=有壓力）
- 關鍵人物用简洁的文字列表

### 9.7 行運概況可视化

**设计要点**:
- 當前大運用图标和颜色标识状态
- 未來主題用 Tag 列表展示
- 提供跳转按钮，方便查看详情

### 9.8 關鍵標籤可视化

**设计要点**:
- 使用不同颜色的 Tag 区分不同类型
- 水平排列，自动换行
- 点击有明确的视觉反馈

---

## 待确认事项

- [x] 页面布局和区块设计（已确认）
- [x] 与「基本信息」的区别（已确认）
- [x] 交互逻辑（点击跳转聊天）（已确认）
- [ ] 四柱總表的具体样式（表头、单元格、日柱高亮等）
- [ ] 折叠卡片的默认展开/收起状态
- [ ] 流通鏈路图的具体实现方式
- [ ] 宮位状态的颜色方案
- [ ] 關鍵標籤的分类和颜色方案
- [ ] 是否需要支持数据刷新

---

## 更新记录

- **创建日期**: 2024年11月
- **文档版本**: v1.2.0
- **最后更新**: 2024年11月
- **更新内容**: 
  - 初始版本
  - 整合命局體質、清濁、體用、做功、宮位、行運等指标
  - 明确与「基本信息」的区别
  - 设计点击跳转聊天的交互流程
- **维护者**: 开发团队

