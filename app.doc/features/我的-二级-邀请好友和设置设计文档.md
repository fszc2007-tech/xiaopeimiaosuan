# 我的-二级-邀请好友和设置设计文档

## 页面概述

本文档包含「我的」模块下的邀请好友和设置页面设计，包括：

- 邀请好友
- 设置

---

## 一、邀请好友页面

### 1.1 页面概述

**页面名称**: 邀请好友 / Invite Friends

**页面定位**:
- **页面类型**: 二级页面
- **用户类型**: 所有用户
- **页面层级**: 从「我的」主页进入
- **访问条件**: 用户登录后可见

**页面目的**: 提供邀请码和邀请链接，支持分享给好友。

---

### 1.2 页面设计

#### 1.2.1 整体布局

页面采用垂直滚动布局（ScrollView），整体背景为纯白色。从上到下依次包含：

1. 页面标题和说明
2. 邀请码展示区域
3. 复制按钮
4. 生成邀请海报按钮（可选）

#### 1.2.2 详细区块设计

**页面标题和说明**:

**位置**: 页面最顶部

**样式**:
- 背景: `colors.bg`（白色）
- 内边距: 左右 `spacing.lg`，顶部 `spacing.lg`
- 底部间距: `spacing.md`

**标题**:
- 文案: 「邀请好友一起玩小佩」
- 字体大小: `fontSizes.lg`
- 字体粗细: `fontWeights.semibold`
- 文字颜色: `colors.ink`
- 底部间距: `spacing.xs`

**说明文字**:
- 文案: 「把小佩分享给身边在意命理、也在寻找答案的朋友。如果未来有活动或奖励，也会在这里统一展示。」
- 字体大小: `fontSizes.sm`
- 文字颜色: `colors.textSecondary`
- 行高: `lineHeights.normal`

**邀请码卡片**:

```
┌─────────────────────────────────────────┐
│  我的邀请码                             │
│  XIAOPEI123                    [复制]   │
└─────────────────────────────────────────┘
```

**卡片样式**:
- 背景: `colors.disabledBg`（浅灰色）或 `colors.cardBg`（白色）
- 圆角: `radius.lg`
- 阴影: `shadows.card`（可选）
- 内边距: `spacing.md`
- 布局: 水平排列，左侧显示邀请码，右侧显示复制按钮
- 顶部间距: `spacing.md`

**邀请码显示**:

1. **标签**:
   - 文案: 「我的邀请码」
   - 字体大小: `fontSizes.xs`
   - 文字颜色: `colors.textSecondary`
   - 底部间距: `spacing.xs`

2. **邀请码**:
   - 显示: `invite_code`（等宽字体）
   - 字体大小: `fontSizes.base`
   - 字体粗细: `fontWeights.semibold`
   - 文字颜色: `colors.ink`
   - 字体: `fontFamily.mono`（等宽字体）

**复制按钮**:

- 按钮类型: `PrimaryButton`（小尺寸）
- 文案: 「复制」
- 背景色: `colors.brandBlue`
- 文字颜色: 白色
- 圆角: `radius.pill`
- 内边距: 左右 `spacing.md`，上下 `spacing.xs`
- 字体大小: `fontSizes.sm`
- 点击行为: 复制邀请码到剪贴板，显示 Toast 提示

**生成邀请海报按钮**（可选）:

**位置**: 邀请码卡片下方

**按钮样式**:
- 按钮类型: `SecondaryButton`（次要按钮）
- 文案: 「生成邀请海报」
- 背景: `colors.bg`（白色）
- 边框: `colors.border`（1px）
- 圆角: `radius.pill`
- 宽度: 100%
- 高度: 44px
- 顶部间距: `spacing.md`
- 点击行为: 生成邀请海报（后续实现）

**邀请统计**（可选）:

**位置**: 生成邀请海报按钮下方

**样式**:
- 背景: `colors.cardBg`（白色）
- 圆角: `radius.lg`
- 阴影: `shadows.card`
- 内边距: `spacing.md`
- 顶部间距: `spacing.md`

**内容**:
- 标题: 「邀请统计」
- 数据: 「已邀请 {{invite_count}} 人」
- 字体大小: `fontSizes.sm`
- 文字颜色: `colors.textSecondary`

---

### 1.3 数据需求

#### 1.3.1 获取邀请码

**接口**: `GET /api/invite/code`

**请求参数**: 无（从 token 中获取用户 ID）

**响应**:
```typescript
interface GetInviteCodeResponse {
  invite_code: string;  // 邀请码
  invite_link?: string; // 邀请链接（可选）
  invite_count?: number; // 已邀请人数（可选）
}
```

#### 1.3.2 复制邀请码

**前端实现**:
- 使用 `Clipboard` API 复制邀请码
- 显示 Toast 提示: 「已复制邀请码：{{invite_code}}」

#### 1.3.3 生成邀请海报

**接口**: `POST /api/invite/poster`

**请求参数**:
```typescript
interface GeneratePosterRequest {
  invite_code: string;
}
```

**响应**:
```typescript
interface GeneratePosterResponse {
  poster_url: string;  // 海报图片 URL
}
```

---

### 1.4 交互流程

#### 1.4.1 用户操作流程

1. **进入页面**
   - 用户从「我的」主页点击「邀请好友」
   - 页面加载邀请码并展示

2. **复制邀请码**
   - 点击「复制」按钮
   - 邀请码复制到剪贴板
   - 显示 Toast 提示

3. **生成邀请海报**（可选）
   - 点击「生成邀请海报」按钮
   - 生成海报图片
   - 支持保存到相册或分享

---

## 二、设置页面

### 2.1 页面概述

**页面名称**: 设置 / Settings

**页面定位**:
- **页面类型**: 二级页面
- **用户类型**: 所有用户
- **页面层级**: 从「我的」主页进入
- **访问条件**: 用户登录后可见

**页面目的**: 提供应用设置、账号管理、隐私设置等功能。

---

### 2.2 页面设计

#### 2.2.1 整体布局

页面采用垂直滚动布局（ScrollView），整体背景为纯白色。从上到下依次包含：

1. 分组一：显示与语言
2. 分组二：命理相关设置
3. 分组三：账号与隐私
4. 分组四：安全操作

#### 2.2.2 详细区块设计

**分组一：显示与语言**

**分组标题**:
- 文案: 「显示与语言」
- 字体大小: `fontSizes.xs`
- 字体粗细: `fontWeights.medium`
- 文字颜色: `colors.textSecondary`
- 内边距: 左右 `spacing.xs`，底部 `spacing.xs`

**卡片样式**:
- 背景: `colors.cardBg`（白色）
- 圆角: `radius.lg`
- 阴影: `shadows.card`
- 内边距: 0（Cell 内部有内边距）
- 底部间距: `spacing.lg`

**Cell 列表**:

1. **主题色 / 外观**:
   - 标题: 「主题色 / 外观」
   - 描述: 「跟随系统（预留）」
   - 点击行为: 预留功能（暂不实现）
   - 右侧: 箭头图标

2. **语言设置**:
   - 标题: 「语言设置」
   - 描述: 显示当前语言（「简体中文」或「繁體中文」）
   - 点击行为: 显示语言信息（不可修改，由 app_region 决定）
   - 右侧: 箭头图标（可选，或显示「仅显示」）

3. **字号设置**:
   - 标题: 「字号设置」
   - 描述: 显示当前字号（「小」「中」「大」）
   - 点击行为: 切换字号大小
   - 右侧: 箭头图标
   - 预览: 下方显示命理文案预览
     - 文案: 「小佩，希望用命理帮你更温柔地看待自己。」
     - 根据选择的字号显示不同大小
     - 字体大小: `fontSizes.xs`（小）、`fontSizes.sm`（中）、`fontSizes.base`（大）

**分组二：命理相关设置**

**分组标题**:
- 文案: 「命理相关设置」
- 样式同「显示与语言」

**卡片样式**:
- 同「显示与语言」卡片样式

**Cell 列表**:

1. **命理规则设置**:
   - 标题: 「命理规则设置」
   - 描述: 「真太阳时、人元司令等进阶规则」
   - 点击行为: 进入命理规则设置页面
   - 路由: `/settings/bazi-rules`
   - 右侧: 箭头图标

2. **接受时运提醒**（开关）:
   - 标题: 「接受时运提醒」
   - 开关: Toggle 组件
   - 默认值: `true`
   - 右侧: Toggle 开关

3. **晚上 22:00–早上 8:00 不推送**（开关）:
   - 标题: 「晚上 22:00–早上 8:00 不推送」
   - 开关: Toggle 组件
   - 默认值: `true`
   - 右侧: Toggle 开关

**分组三：账号与隐私**

**分组标题**:
- 文案: 「账号与隐私」
- 样式同「显示与语言」

**卡片样式**:
- 同「显示与语言」卡片样式

**Cell 列表**:

1. **账号与安全**:
   - 标题: 「账号与安全」
   - 描述: 「手机号绑定 / 其他登录方式」
   - 点击行为: 进入账号与安全页面
   - 路由: `/settings/account-security`
   - 右侧: 箭头图标

2. **数据与隐私**:
   - 标题: 「数据与隐私」
   - 描述: 「隐私政策、数据导出与注销」
   - 点击行为: 进入数据与隐私页面
   - 路由: `/settings/privacy`
   - 右侧: 箭头图标

3. **关于小佩**:
   - 标题: 「关于小佩」
   - 描述: 「小佩，希望用命理帮你更温柔地看待自己。」
   - 点击行为: 进入关于小佩页面
   - 路由: `/settings/about`
   - 右侧: 箭头图标

**分组四：安全操作**

**分组标题**: 无（直接显示 Cell）

**卡片样式**:
- 同「显示与语言」卡片样式

**Cell 列表**:

1. **退出登录**:
   - 标题: 「退出登录」
   - 文字颜色: `colors.error`（红色）
   - 点击行为: 弹出确认框，确认后退出登录
   - 右侧: 箭头图标（可选）

**Cell 样式**:
- 高度: 64px（最小）
- 内边距: 左右 `spacing.lg`，上下 `spacing.md`
- 边框: 底部 `colors.border`（1px），最后一个无边框
- 点击反馈: `activeOpacity: 0.7`

**Cell 内容布局**:
- 左侧: 标题和描述
- 右侧: 箭头图标或 Toggle 开关

**标题样式**:
- 字体大小: `fontSizes.base`
- 字体粗细: `fontWeights.regular`
- 文字颜色: `colors.ink`（退出登录为 `colors.error`）

**描述样式**:
- 字体大小: `fontSizes.sm`
- 文字颜色: `colors.textSecondary`
- 顶部间距: `spacing.xs`

**Toggle 组件样式**:
- 宽度: 40px
- 高度: 24px
- 圆角: `radius.pill`
- 开启背景: `colors.brandGreen`
- 关闭背景: `colors.disabledBg`
- 滑块: 白色圆形，20x20px
- 过渡动画: 平滑过渡

---

### 2.3 数据需求

#### 2.3.1 获取设置

**接口**: `GET /api/settings`

**请求参数**: 无（从 token 中获取用户 ID）

**响应**:
```typescript
interface GetSettingsResponse {
  language: 'zh-CN' | 'zh-HK';
  font_size: 'small' | 'medium' | 'large';
  accept_notifications: boolean;
  quiet_hours: boolean;  // 22:00-8:00 不推送
  bazi_rules: {
    true_solar_time: boolean;
    // 其他命理规则设置
  };
}
```

#### 2.3.2 更新设置

**接口**: `PUT /api/settings`

**请求参数**:
```typescript
interface UpdateSettingsRequest {
  font_size?: 'small' | 'medium' | 'large';
  accept_notifications?: boolean;
  quiet_hours?: boolean;
  bazi_rules?: {
    true_solar_time?: boolean;
    // 其他命理规则设置
  };
}
```

**响应**:
```typescript
interface UpdateSettingsResponse {
  success: boolean;
  message: string;
}
```

#### 2.3.3 退出登录

**接口**: `POST /api/auth/logout`

**请求参数**: 无（从 token 中获取用户 ID）

**响应**:
```typescript
interface LogoutResponse {
  success: boolean;
  message: string;
}
```

---

### 2.4 交互流程

#### 2.4.1 用户操作流程

1. **进入页面**
   - 用户从「我的」主页点击「设置」
   - 页面加载设置数据并展示

2. **修改设置**
   - 点击 Cell 或切换 Toggle
   - 设置立即保存（或显示保存按钮）
   - 显示保存成功提示

3. **退出登录**
   - 点击「退出登录」Cell
   - 弹出确认框
   - 确认后调用退出登录接口
   - 清除本地 token 和用户数据
   - 跳转到登录页面

---

## 技术实现

### 3.1 技术要点

- 列表展示（FlatList 或 ScrollView）
- Toggle 开关组件
- 路由跳转
- 数据加载和保存
- 退出登录逻辑
- 剪贴板操作（邀请码）

### 3.2 相关文件结构

```
src/
├── screens/
│   └── Me/
│       ├── InviteFriendsScreen.tsx    # 邀请好友页面
│       ├── SettingsScreen.tsx         # 设置页面
│       └── components/
│           ├── Section.tsx            # 分组组件
│           ├── Cell.tsx               # Cell 组件
│           ├── Toggle.tsx             # Toggle 开关组件
│           └── InviteCodeCard.tsx     # 邀请码卡片组件
├── services/
│   └── api/
│       ├── inviteService.ts           # 邀请 API
│       └── settingsService.ts         # 设置 API
└── types/
    ├── invite.ts                      # 邀请类型定义
    └── settings.ts                    # 设置类型定义
```

---

## 设计规范

### 4.1 视觉设计

- **遵循 UI_SPEC.md 中的设计规范**
- 使用 Design Tokens（colors, typography, layout）
- 整体背景为纯白色
- 卡片使用圆角、边框、阴影区分层级
- 保持充足的留白

### 4.2 交互设计

- 列表滚动流畅
- Cell 点击反馈明确
- Toggle 开关动画平滑
- 跳转动画平滑

### 4.3 响应式设计

- 适配不同屏幕尺寸
- 内容在小屏设备上可正常滚动

---

## 待确认事项

- [x] 页面布局和区块设计（已确认）
- [ ] 邀请海报的具体设计
- [ ] 命理规则设置页面的具体设计
- [ ] 账号与安全页面的具体设计
- [ ] 数据与隐私页面的具体设计
- [ ] 关于小佩页面的具体设计

---

## 更新记录

- **创建日期**: 2024年11月
- **文档版本**: v1.0.0
- **最后更新**: 2024年11月
- **更新内容**: 
  - 初始版本
  - 包含邀请好友和设置页面设计
- **维护者**: 开发团队

