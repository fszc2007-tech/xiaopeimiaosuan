# 手动执行日主解读数据库迁移

## 方法 1：使用数据库管理工具

### 如果你使用 Navicat / TablePlus / MySQL Workbench：

1. 打开数据库管理工具
2. 连接到 `xiaopei` 数据库
3. 打开 SQL 执行窗口
4. 复制并执行以下 SQL（或直接打开文件 `core/src/database/migrations/009_create_day_stem_readings.sql`）

---

## 方法 2：使用命令行

### 在终端执行：

```bash
# 进入项目目录
cd /Users/gaoxuxu/Desktop/xiaopei-app

# 执行迁移（会提示输入密码）
mysql -u root -p xiaopei < core/src/database/migrations/009_create_day_stem_readings.sql
```

**提示输入密码时，输入你的 MySQL root 密码**

---

## 方法 3：直接复制 SQL 执行

### SQL 内容（复制到数据库工具中执行）：

```sql
-- 创建表
CREATE TABLE IF NOT EXISTS day_stem_readings (
  stem CHAR(1) PRIMARY KEY COMMENT '日主天干',
  element VARCHAR(10) NOT NULL COMMENT '五行',
  yin_yang VARCHAR(10) NOT NULL COMMENT '阴阳',
  title VARCHAR(50) NOT NULL COMMENT '标题',
  description TEXT NOT NULL COMMENT '描述',
  created_at DATETIME DEFAULT CURRENT_TIMESTAMP,
  updated_at DATETIME DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;

-- 插入 10 条数据
INSERT INTO day_stem_readings (stem, element, yin_yang, title, description) VALUES
('甲', '木', '阳', '甲木日主', '你是甲木日主，如同挺直向上的大樹，天生帶著正氣與擔當，遇事講原則，也願意為信念站在前面。你內心頑強，有越挫越勇的生命力，不喜歡彎彎繞繞。只是有時容易太硬，不知不覺扛起太多；若能學會適度轉彎、聽進不同聲音，你的堅持會變成更有溫度的力量。'),
('乙', '木', '阴', '乙木日主', '你是乙木日主，好比柔韌的藤蔓與花木，外表溫和，內心卻有不服輸的韌性，懂得順勢而生，在環境變化中慢慢尋找出口。你善於感受氣氛，願意配合與協調人際，只是有時太顧全大家而委屈自己。若能適度立下界線、說清想法，你的溫柔會更有力量，而不是被視為理所當然。'),
('丙', '火', '阳', '丙火日主', '你是丙火日主，如烈日當空，熱情外放，喜歡光明坦蕩地表達自己，遇事反應快速，敢說敢做，常不自覺成為帶頭的人。你有點急性子，討厭拖延與含糊，行動力十足；只是情緒起伏時，容易一時衝動。若能學會在出手前多停一拍，你的火力會更聚焦，既溫暖人心，又減少不必要的消耗。'),
('丁', '火', '阴', '丁火日主', '你是丁火日主，像燭火與爐火，光不刺眼卻持續溫暖，對人細膩體貼，常默默照顧他人感受。你外表溫柔，內在卻相當堅韌，願意長久守候與投入，只是不太擅長表達疲累，容易為了顧全局而壓抑自己。若能多心疼自己一分，把真實感受說出來，你的溫暖會更穩定長久。'),
('戊', '土', '阳', '戊土日主', '你是戊土日主，如同高山厚土，穩重踏實，重視承諾與責任感，遇到風雨也能咬牙撐住，是讓人自然依靠的類型。你做決定傾向保守謹慎，不喜歡冒失變動，只是有時顯得固執，不易改口。若能在堅守原則之餘，留下少許彈性，你的可靠會更可親，也不會讓自己背負過重。'),
('己', '土', '阴', '己土日主', '你是己土日主，像園田沃土，包容細微，擅長整理與照顧細節，看到別人需要時會自然伸出援手。你重視安全感，也願意默默支持身邊的人，只是容易思前想後，擔心過頭，把很多責任往自己身上攬。若能學會適度放下與信任，清楚說明界線，你的溫厚就能既溫柔又有底氣。'),
('庚', '金', '阳', '庚金日主', '你是庚金日主，如同一把鋒利而正直的寶劍，性子爽快不拖泥帶水，遇事習慣正面迎上，對原則有強烈的堅持，也帶著開創與革新的膽識。你天生抗壓、有棱有角，能在困局中劈荊斬棘，但有時容易過剛，對自己和他人要求偏高。若能學會適度收鋒，保留一點柔軟與變通，你的果決就會成為他人可靠的依靠，而不是無形的壓力。'),
('辛', '金', '阴', '辛金日主', '你是辛金日主，好比經過打磨的珠玉與利器，氣質內斂卻帶著銳利眼光，對細節與品質特別敏感。你有自己的美感與標準，不喜歡隨便將就，做事追求精準到位，只是有時容易對自己過於苛刻，陷入完美主義。若能給自己更多寬容，接受適度的不完美，你的堅持會顯得優雅而清爽。'),
('壬', '水', '阳', '壬水日主', '你是壬水日主，如江河大海，胸襟開闊、思路靈活，喜歡保有流動的空間，不愛被框死在僵硬規則裡。你想像力豐富，能兼容不同觀點，遇到變化也較能調整方向，只是情緒高低起伏時，容易一下子想很多。若能為自己找到穩定心境的錨點，你的靈感會更穩定，成為溫柔而強大的力量。'),
('癸', '水', '阴', '癸水日主', '你是癸水日主，如細雨與晨露，感受細膩，心思敏感而柔軟，容易捕捉到他人沒說出口的情緒與氣氛。你天生具有同理與直覺，適合用溫和方式影響周圍，只是有時太在意他人反應，反而忽略了自己。若能學會先照顧好內心，不逞強去迎合，你的溫柔將更有邊界，也更讓人安心。');
```

---

## 验证是否成功

### 执行完成后，检查数据：

```sql
-- 查看表是否创建
SHOW TABLES LIKE 'day_stem_readings';

-- 查看数据是否插入（应该返回 10 行）
SELECT stem, title FROM day_stem_readings 
ORDER BY FIELD(stem, '甲', '乙', '丙', '丁', '戊', '己', '庚', '辛', '壬', '癸');
```

**预期结果**：
```
+------+--------------+
| stem | title        |
+------+--------------+
| 甲   | 甲木日主     |
| 乙   | 乙木日主     |
| 丙   | 丙火日主     |
| 丁   | 丁火日主     |
| 戊   | 戊土日主     |
| 己   | 己土日主     |
| 庚   | 庚金日主     |
| 辛   | 辛金日主     |
| 壬   | 壬水日主     |
| 癸   | 癸水日主     |
+------+--------------+
10 rows in set
```

---

## 执行完成后

1. **重启 Core 后端**（如果已经在运行）：
   ```bash
   # Ctrl+C 停止，然后重新启动
   cd core
   npm run dev
   ```

2. **刷新 App**：
   - 杀掉 App 进程并重新打开
   - 或者在 Expo 中按 `r` 键刷新

3. **查看效果**：
   - 进入命盘详情 → 基本信息 Tab
   - 查看「日主概览」卡片
   - 应该显示完整的日主解读文案

---

## 如果还是不行

请截图告诉我：
1. 数据库执行结果
2. Core 后端终端日志
3. App 的错误信息

