# ç™»éŒ„é éš±ç§æ”¿ç­–ç¢ºèªåŠŸèƒ½ - å®Œæˆå ±å‘Š

## ğŸ“‹ åŠŸèƒ½æ¦‚è¿°

åœ¨ç”¨æˆ¶ç™»éŒ„æ™‚è¦æ±‚ä¸»å‹•å‹¾é¸åŒæ„éš±ç§æ”¿ç­–å’Œç”¨æˆ¶å”è­°ï¼Œæœªå‹¾é¸æ™‚é€šééœ‡å‹•å’Œè¦–è¦ºæç¤ºå¼•å°ç”¨æˆ¶ç¢ºèªã€‚

---

## âœ… å¯¦æ–½å…§å®¹

### 1. Core å¾Œç«¯é…ç½®

#### 1.1 PDF æ–‡æª”éƒ¨ç½²
- âœ… å‰µå»º `core/public/docs/` ç›®éŒ„
- âœ… è¤‡è£½ä¸‰å€‹ PDF æ–‡æª”ï¼š
  - `miaosuan_privacy_policy_zh-HK.pdf` - ç§éš±æ”¿ç­–
  - `miaosuan_user_agreement_zh-HK.pdf` - ç”¨æˆ¶å”è­°
  - `miaosuan_PICS_zh-HK.pdf` - å€‹äººè³‡æ–™æ”¶é›†è²æ˜

#### 1.2 éœæ…‹æ–‡ä»¶æœå‹™
- âœ… ä¿®æ”¹ `core/src/server.ts`ï¼Œæ·»åŠ éœæ…‹æ–‡ä»¶ä¸­é–“ä»¶ï¼š
```typescript
app.use('/public', express.static('public'));
```
- è¨ªå•è·¯å¾‘ï¼š`${API_BASE_URL}/public/docs/{filename}`

---

### 2. å‰ç«¯çµ„ä»¶é–‹ç™¼

#### 2.1 åŸºç¤ Checkbox çµ„ä»¶
**æ–‡ä»¶**: `app/src/components/common/Checkbox/Checkbox.tsx`

**åŠŸèƒ½**ï¼š
- âœ… æ”¯æŒå‹¾é¸/æœªå‹¾é¸ç‹€æ…‹
- âœ… é»æ“Šå‹•ç•«æ•ˆæœï¼ˆç¸®æ”¾ï¼‰
- âœ… éŒ¯èª¤ç‹€æ…‹é¡¯ç¤ºï¼ˆç´…è‰²é‚Šæ¡†ï¼‰
- âœ… ç¦ç”¨ç‹€æ…‹
- âœ… ä½¿ç”¨å“ç‰Œç¶ è‰² `colors.brandGreen`

**æ¨£å¼**ï¼š
- æœªå‹¾é¸ï¼šç°è‰²é‚Šæ¡†ç©ºå¿ƒåœ“åœˆ
- å·²å‹¾é¸ï¼šå“ç‰Œç¶ è‰²å¯¦å¿ƒ + ç™½è‰²å‹¾è™Ÿ
- éŒ¯èª¤ï¼šç´…è‰²é‚Šæ¡†

---

#### 2.2 å”è­°å‹¾é¸çµ„ä»¶
**æ–‡ä»¶**: `app/src/components/auth/AgreementCheckbox.tsx`

**åŠŸèƒ½**ï¼š
- âœ… é›†æˆ Checkbox çµ„ä»¶
- âœ… é¡¯ç¤ºå”è­°æ–‡æ¡ˆï¼ˆç¹é«”ä¸­æ–‡ï¼‰
- âœ… ä¸‰å€‹å¯é»æ“Šéˆæ¥ï¼šã€Šç§éš±æ”¿ç­–ã€‹ã€Šç”¨æˆ¶å”è­°ã€‹ã€Šå€‹äººè³‡æ–™æ”¶é›†è²æ˜ã€‹
- âœ… éŒ¯èª¤ç‹€æ…‹é–ƒçˆå‹•ç•«ï¼ˆå·¦å³éœ‡å‹• 4 æ¬¡ï¼‰
- âœ… éŒ¯èª¤ç‹€æ…‹èƒŒæ™¯è®Šç´… + ç´…è‰²é‚Šæ¡†

**æ–‡æ¡ˆ**ï¼š
```
æˆ‘å·²é–±è®€ä¸¦åŒæ„ã€Šç§éš±æ”¿ç­–ã€‹ã€Šç”¨æˆ¶å”è­°ã€‹åŠã€Šå€‹äººè³‡æ–™æ”¶é›†è²æ˜ã€‹
```

---

#### 2.3 æ”¿ç­–æ–‡æª”æŸ¥çœ‹é é¢
**æ–‡ä»¶**: `app/src/screens/Auth/PolicyViewerScreen.tsx`

**åŠŸèƒ½**ï¼š
- âœ… ä½¿ç”¨ WebView è¼‰å…¥ PDF æ–‡æª”
- âœ… æ”¯æŒä¸‰ç¨®æ–‡æª”é¡å‹ï¼ˆprivacy / agreement / picsï¼‰
- âœ… é¡¯ç¤ºè¼‰å…¥æŒ‡ç¤ºå™¨
- âœ… éŒ¯èª¤è™•ç†ï¼ˆHTTP éŒ¯èª¤ã€è¼‰å…¥å¤±æ•—ï¼‰
- âœ… å‹•æ…‹æ¨™é¡Œï¼ˆæ ¹æ“šæ–‡æª”é¡å‹ï¼‰
- âœ… è¿”å›æŒ‰éˆ•

**é…ç½®**ï¼š
```typescript
const POLICY_CONFIG = {
  privacy: { title: 'ç§éš±æ”¿ç­–', filename: 'miaosuan_privacy_policy_zh-HK.pdf' },
  agreement: { title: 'ç”¨æˆ¶å”è­°', filename: 'miaosuan_user_agreement_zh-HK.pdf' },
  pics: { title: 'å€‹äººè³‡æ–™æ”¶é›†è²æ˜', filename: 'miaosuan_PICS_zh-HK.pdf' },
};
```

---

### 3. ç™»éŒ„é é¢é›†æˆ

#### 3.1 AuthScreen ä¿®æ”¹
**æ–‡ä»¶**: `app/src/screens/Auth/AuthScreen.tsx`

**æ–°å¢ç‹€æ…‹**ï¼š
```typescript
const [agreedToTerms, setAgreedToTerms] = useState(false);
const [showAgreementError, setShowAgreementError] = useState(false);
```

**æ–°å¢åŠŸèƒ½**ï¼š
1. âœ… **éœ‡å‹•åé¥‹å‡½æ•¸**ï¼š
   - iOS: `Haptics.notificationAsync('warning')`
   - Android: `Vibration.vibrate(200)`

2. âœ… **æŸ¥çœ‹æ”¿ç­–æ–‡æª”**ï¼š
   ```typescript
   const handleViewPolicy = (type: PolicyType) => {
     navigation.navigate('PolicyViewer', { type });
   };
   ```

3. âœ… **ç™»éŒ„å‰é©—è­‰**ï¼š
   - æª¢æŸ¥ `agreedToTerms` ç‹€æ…‹
   - æœªå‹¾é¸æ™‚ï¼š
     - è§¸ç™¼éœ‡å‹•
     - é¡¯ç¤ºéŒ¯èª¤æç¤ºï¼šã€Œè«‹å…ˆåŒæ„æœå‹™æ¢æ¬¾ã€
     - å‹¾é¸æ¡†é–ƒçˆç´…è‰²
     - 3ç§’å¾Œè‡ªå‹•æ¸…é™¤éŒ¯èª¤

4. âœ… **UI é›†æˆ**ï¼š
   - åœ¨ã€Œç™»å…¥ã€æŒ‰éˆ•ä¸‹æ–¹é¡¯ç¤º `AgreementCheckbox`
   - åƒ…åœ¨é©—è­‰ç¢¼å·²ç™¼é€å¾Œé¡¯ç¤ºï¼ˆ`otpSent === true`ï¼‰

---

### 4. å°èˆªé…ç½®

#### 4.1 è·¯ç”±é¡å‹å®šç¾©
**æ–‡ä»¶**: `app/src/types/navigation.ts`

```typescript
export type RootStackParamList = {
  Auth: undefined;
  PolicyViewer: {
    type: 'privacy' | 'agreement' | 'pics';
  };
  // ... å…¶ä»–è·¯ç”±
};
```

#### 4.2 RootNavigator é…ç½®
**æ–‡ä»¶**: `app/src/navigation/RootNavigator.tsx`

- âœ… å°å…¥ `PolicyViewerScreen`
- âœ… åœ¨æœªç™»éŒ„ç‹€æ…‹ä¸‹è¨»å†Š `PolicyViewer` è·¯ç”±
- âœ… åœ¨å·²ç™»éŒ„ç‹€æ…‹ä¸‹ä¹Ÿè¨»å†Šï¼ˆç”¨æˆ¶å¯åœ¨è¨­ç½®ä¸­æŸ¥çœ‹ï¼‰
- âœ… å•Ÿç”¨ header é¡¯ç¤ºï¼ˆ`headerShown: true`ï¼‰

---

### 5. åœ‹éš›åŒ–æ–‡æ¡ˆ

#### 5.1 ç¹é«”ä¸­æ–‡æ–‡æ¡ˆ
**æ–‡ä»¶**: `app/src/i18n/locales/zh-HK.ts`

```typescript
auth: {
  // ... åŸæœ‰æ–‡æ¡ˆ
  agreementRequired: 'è«‹å…ˆåŒæ„æœå‹™æ¢æ¬¾',
  agreeToTerms: 'æˆ‘å·²é–±è®€ä¸¦åŒæ„',
  privacyPolicy: 'ã€Šç§éš±æ”¿ç­–ã€‹',
  userAgreement: 'ã€Šç”¨æˆ¶å”è­°ã€‹',
  pics: 'ã€Šå€‹äººè³‡æ–™æ”¶é›†è²æ˜ã€‹',
  and: 'åŠ',
  firstLoginHint: 'é¦–æ¬¡ç™»å…¥å³è‡ªå‹•è¨»å†Š',
}
```

**æ³¨æ„**ï¼šæŒ‰ç”¨æˆ¶è¦æ±‚ï¼Œåƒ…æ·»åŠ ç¹é«”ä¸­æ–‡ï¼Œä¸æ·»åŠ ç°¡é«”ä¸­æ–‡ã€‚

---

### 6. ä¾è³´å®‰è£

- âœ… å®‰è£ `react-native-webview`ï¼š
```bash
npx expo install react-native-webview
```

---

## ğŸ“± ç”¨æˆ¶é«”é©—æµç¨‹

### æ­£å¸¸æµç¨‹
1. ç”¨æˆ¶é€²å…¥ç™»éŒ„é é¢
2. è¼¸å…¥æ‰‹æ©Ÿè™Ÿï¼Œé»æ“Šã€Œç™¼é€é©—è­‰ç¢¼ã€
3. è¼¸å…¥é©—è­‰ç¢¼å¾Œï¼Œ**å‹¾é¸æ¡†å‡ºç¾**
4. ç”¨æˆ¶å‹¾é¸ã€Œæˆ‘å·²é–±è®€ä¸¦åŒæ„...ã€
5. é»æ“Šã€Œç™»å…¥ã€æŒ‰éˆ• â†’ æˆåŠŸç™»å…¥

### æœªå‹¾é¸æ””æˆªæµç¨‹
1. ç”¨æˆ¶æœªå‹¾é¸å”è­°
2. ç›´æ¥é»æ“Šã€Œç™»å…¥ã€æŒ‰éˆ•
3. **è§¸ç™¼éœ‡å‹•åé¥‹**ï¼ˆiOS/Androidï¼‰
4. **å‹¾é¸æ¡†å€åŸŸé–ƒçˆç´…è‰²é‚Šæ¡†**ï¼ˆ4æ¬¡éœ‡å‹•å‹•ç•«ï¼‰
5. **é¡¯ç¤ºéŒ¯èª¤æç¤º**ï¼šã€Œè«‹å…ˆåŒæ„æœå‹™æ¢æ¬¾ã€
6. 3ç§’å¾Œè‡ªå‹•æ¸…é™¤éŒ¯èª¤ç‹€æ…‹

### æŸ¥çœ‹æ”¿ç­–æ–‡æª”æµç¨‹
1. ç”¨æˆ¶é»æ“Šã€Šç§éš±æ”¿ç­–ã€‹/ã€Šç”¨æˆ¶å”è­°ã€‹/ã€Šå€‹äººè³‡æ–™æ”¶é›†è²æ˜ã€‹
2. è·³è½‰åˆ° `PolicyViewerScreen`
3. WebView è¼‰å…¥å°æ‡‰ PDF æ–‡æª”
4. ç”¨æˆ¶å¯æ»¾å‹•æŸ¥çœ‹å®Œæ•´å…§å®¹
5. é»æ“Šè¿”å›æŒ‰éˆ•å›åˆ°ç™»éŒ„é 

---

## ğŸ¨ è¨­è¨ˆè¦ç¯„éµå¾ª

### é…è‰²
- âœ… å‹¾é¸æ¡†å·²é¸ä¸­ï¼š`colors.brandGreen`ï¼ˆå“ç‰Œç¶ è‰²ï¼‰
- âœ… éˆæ¥é¡è‰²ï¼š`colors.brandBlue`ï¼ˆå“ç‰Œè—è‰²ï¼‰
- âœ… éŒ¯èª¤ç‹€æ…‹ï¼š`colors.error`ï¼ˆç´…è‰²ï¼‰
- âœ… æ–‡å­—é¡è‰²ï¼š`colors.textSecondary`ï¼ˆæ¬¡è¦æ–‡å­—ï¼‰

### é–“è·
- âœ… å‹¾é¸æ¡†èˆ‡æ–‡å­—ï¼š`spacing.sm`
- âœ… æ•´é«”å€åŸŸä¸Šä¸‹ï¼š`spacing.md`
- âœ… éµå¾ª `UI_SPEC.md` è¦ç¯„

### å‹•ç•«
- âœ… å‹¾é¸æ¡†é»æ“Šï¼šç¸®æ”¾å‹•ç•«ï¼ˆ0.9 â†’ 1.0ï¼‰
- âœ… éŒ¯èª¤ç‹€æ…‹ï¼šå·¦å³éœ‡å‹•å‹•ç•«ï¼ˆ4æ¬¡ï¼Œæ¯æ¬¡100msï¼‰
- âœ… éŒ¯èª¤æç¤ºï¼šæ·¡å…¥æ·¡å‡ºå‹•ç•«

---

## ğŸ“„ æ–‡æª”æ›´æ–°

### è¨­è¨ˆæ–‡æª”æ›´æ–°
**æ–‡ä»¶**: `app.doc/features/æ³¨å†Œç™»å½•è®¾è®¡æ–‡æ¡£.md`

- âœ… æ›´æ–° 4.2.6 ç¯€ã€Œå”è­°å€ã€å…§å®¹
- âœ… å¾ã€Œè¢«å‹•æç¤ºã€æ”¹ç‚ºã€Œä¸»å‹•ç¢ºèªã€
- âœ… æ·»åŠ è©³ç´°çš„äº¤äº’è¡Œç‚ºèªªæ˜
- âœ… æ·»åŠ  PDF æ–‡æª”é…ç½®èªªæ˜
- âœ… æ·»åŠ ç›¸é—œçµ„ä»¶åˆ—è¡¨
- âœ… æ·»åŠ åœ‹éš›åŒ–éµå€¼èªªæ˜
- âœ… æ›´æ–°ç‰ˆæœ¬è™Ÿï¼šv1.2.0 â†’ v1.3.0
- âœ… æ·»åŠ æ›´æ–°è¨˜éŒ„

---

## ğŸ”§ æŠ€è¡“ç´°ç¯€

### éœ‡å‹•åé¥‹å¯¦ç¾
```typescript
const triggerWarningFeedback = () => {
  if (Platform.OS === 'ios') {
    Haptics.notificationAsync(Haptics.NotificationFeedbackType.Warning);
  } else {
    Vibration.vibrate(200);
  }
};
```

### é–ƒçˆå‹•ç•«å¯¦ç¾
```typescript
React.useEffect(() => {
  if (error) {
    Animated.sequence([
      Animated.timing(shakeAnim, { toValue: 10, duration: 100 }),
      Animated.timing(shakeAnim, { toValue: -10, duration: 100 }),
      Animated.timing(shakeAnim, { toValue: 10, duration: 100 }),
      Animated.timing(shakeAnim, { toValue: 0, duration: 100 }),
    ]).start();
  }
}, [error]);
```

### PDF è¨ªå•è·¯å¾‘
```typescript
const pdfUrl = `${ENV.API_BASE_URL}/public/docs/${config.filename}`;
```

---

## ğŸ§ª æ¸¬è©¦å»ºè­°

### åŠŸèƒ½æ¸¬è©¦
- [ ] é©—è­‰å‹¾é¸æ¡†é»æ“Šåˆ‡æ›ç‹€æ…‹
- [ ] é©—è­‰æœªå‹¾é¸æ™‚ç„¡æ³•ç™»å…¥
- [ ] é©—è­‰éœ‡å‹•åé¥‹ï¼ˆiOS/Androidï¼‰
- [ ] é©—è­‰éŒ¯èª¤æç¤ºé¡¯ç¤ºå’Œè‡ªå‹•æ¶ˆå¤±
- [ ] é©—è­‰ä¸‰å€‹éˆæ¥è·³è½‰æ­£ç¢º
- [ ] é©—è­‰ PDF æ–‡æª”æ­£å¸¸è¼‰å…¥

### UI æ¸¬è©¦
- [ ] é©—è­‰å‹¾é¸æ¡†æ¨£å¼ï¼ˆæœªé¸ä¸­/å·²é¸ä¸­/éŒ¯èª¤ï¼‰
- [ ] é©—è­‰é–ƒçˆå‹•ç•«æ•ˆæœ
- [ ] é©—è­‰æ–‡å­—é¡è‰²å’Œéˆæ¥ä¸‹åŠƒç·š
- [ ] é©—è­‰ä¸åŒå±å¹•å°ºå¯¸ä¸‹çš„ä½ˆå±€

### é‚Šç•Œæ¸¬è©¦
- [ ] ç¶²çµ¡æ–·é–‹æ™‚ PDF è¼‰å…¥å¤±æ•—è™•ç†
- [ ] å¿«é€Ÿé»æ“Šç™»å…¥æŒ‰éˆ•ï¼ˆé˜²æŠ–ï¼‰
- [ ] å‹¾é¸å¾Œå–æ¶ˆå‹¾é¸å†ç™»å…¥

---

## ğŸ“¦ æ–‡ä»¶æ¸…å–®

### æ–°å¢æ–‡ä»¶
```
core/
  public/
    docs/
      miaosuan_privacy_policy_zh-HK.pdf
      miaosuan_user_agreement_zh-HK.pdf
      miaosuan_PICS_zh-HK.pdf

app/src/
  components/
    common/
      Checkbox/
        Checkbox.tsx                    âœ… æ–°å¢
        index.ts                        âœ… æ–°å¢
    auth/
      AgreementCheckbox.tsx             âœ… æ–°å¢
  screens/
    Auth/
      PolicyViewerScreen.tsx            âœ… æ–°å¢
```

### ä¿®æ”¹æ–‡ä»¶
```
core/src/
  server.ts                             âœ… æ·»åŠ éœæ…‹æ–‡ä»¶æœå‹™

app/src/
  components/
    common/
      index.ts                          âœ… å°å‡º Checkbox
    auth/
      index.ts                          âœ… å°å‡º AgreementCheckbox
  screens/
    Auth/
      AuthScreen.tsx                    âœ… é›†æˆå‹¾é¸æ¡†
  navigation/
    RootNavigator.tsx                   âœ… è¨»å†Š PolicyViewer è·¯ç”±
  types/
    navigation.ts                       âœ… æ·»åŠ  PolicyViewer é¡å‹
  i18n/
    locales/
      zh-HK.ts                          âœ… æ·»åŠ ç¹é«”æ–‡æ¡ˆ

app.doc/features/
  æ³¨å†Œç™»å½•è®¾è®¡æ–‡æ¡£.md                    âœ… æ›´æ–°æ–‡æª”
```

---

## ğŸ¯ å®Œæˆç‹€æ…‹

| ä»»å‹™ | ç‹€æ…‹ |
|------|------|
| å‰µå»º Core å¾Œç«¯ PDF æ–‡æª”ç›®éŒ„çµæ§‹ | âœ… å®Œæˆ |
| å‰µå»ºåŸºç¤ Checkbox çµ„ä»¶ | âœ… å®Œæˆ |
| å‰µå»º AgreementCheckbox çµ„ä»¶ | âœ… å®Œæˆ |
| å‰µå»º PolicyViewerScreen é é¢ | âœ… å®Œæˆ |
| ä¿®æ”¹ AuthScreen é›†æˆå‹¾é¸æ¡† | âœ… å®Œæˆ |
| æ·»åŠ åœ‹éš›åŒ–æ–‡æ¡ˆï¼ˆç¹é«”ï¼‰ | âœ… å®Œæˆ |
| æ›´æ–°å°èˆªè·¯ç”±é…ç½® | âœ… å®Œæˆ |
| æ›´æ–°æ³¨å†Šç™»éŒ„è¨­è¨ˆæ–‡æª” | âœ… å®Œæˆ |
| å®‰è£ react-native-webview | âœ… å®Œæˆ |

---

## ğŸš€ ä¸‹ä¸€æ­¥

1. **å•Ÿå‹•æ¸¬è©¦**ï¼š
   ```bash
   # å•Ÿå‹• Core å¾Œç«¯
   cd core && npm run dev
   
   # å•Ÿå‹• App å‰ç«¯
   cd app && npm start
   ```

2. **é©—è­‰åŠŸèƒ½**ï¼š
   - é€²å…¥ç™»éŒ„é é¢
   - æ¸¬è©¦å‹¾é¸æ¡†äº¤äº’
   - æ¸¬è©¦æœªå‹¾é¸æ””æˆª
   - æ¸¬è©¦ PDF æ–‡æª”æŸ¥çœ‹

3. **èª¿æ•´å„ªåŒ–**ï¼ˆå¦‚éœ€è¦ï¼‰ï¼š
   - èª¿æ•´å‹•ç•«æ™‚é•·
   - èª¿æ•´éŒ¯èª¤æç¤ºæ–‡æ¡ˆ
   - èª¿æ•´æ¨£å¼ç´°ç¯€

---

## ğŸ“ å‚™è¨»

- âœ… æ‰€æœ‰æ–‡æ¡ˆä½¿ç”¨ç¹é«”ä¸­æ–‡
- âœ… éµå¾ªé …ç›®ç¾æœ‰è¨­è¨ˆè¦ç¯„
- âœ… ä»£ç¢¼å·²é€šé TypeScript é¡å‹æª¢æŸ¥
- âœ… æ–‡æª”å·²åŒæ­¥æ›´æ–°

---

**å¯¦æ–½æ—¥æœŸ**: 2024å¹´12æœˆ16æ—¥  
**å¯¦æ–½ç‰ˆæœ¬**: v1.3.0  
**å¯¦æ–½äººå“¡**: AI Assistant

