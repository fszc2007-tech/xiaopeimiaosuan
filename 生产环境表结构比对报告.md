# 生产环境表结构比对报告

生成时间: 2025-12-26

## 比对结果

### 表数量
- **开发环境**: 25 张表
- **生产环境**: 24 张表
- **差异**: 生产环境缺失 1 张表

### 缺失的表
- ❌ `llm_api_config` - 生产环境不存在（开发环境存在）
  - **说明**: 这是重复表，开发环境同时有 `llm_api_config` 和 `llm_api_configs`
  - **建议**: 可以忽略，或删除开发环境的 `llm_api_config` 表

### 列差异

#### conversations 表
- **字段**: `title`
- **开发环境**: `varchar(255)`
- **生产环境**: `varchar(200)`
- **影响**: 轻微，生产环境长度限制更小，但 200 字符通常足够

### 关键表结构比对

#### 1. llm_api_configs
- **开发环境**: 15 列
- **生产环境**: 15 列
- **状态**: ✅ 一致

#### 2. conversations
- **开发环境**: 11 列
- **生产环境**: 11 列
- **状态**: ⚠️ `title` 字段类型不一致（varchar(255) vs varchar(200)）

#### 3. users
- **开发环境**: 25 列
- **生产环境**: 25 列
- **状态**: ✅ 一致

#### 4. shensha_readings
- **开发环境**: 16 列
- **生产环境**: 16 列
- **状态**: ✅ 一致

## 已执行的迁移

### Migration 044: 修复神煞解读表编码
- **状态**: 待执行（需要调用 API）
- **目的**: 确保 `shensha_readings` 表使用 utf8mb4 字符集

## 建议的修复

1. **conversations.title 字段类型统一**
   - 选项 A: 将生产环境改为 `varchar(255)`（推荐）
   - 选项 B: 将开发环境改为 `varchar(200)`

2. **删除重复表 llm_api_config**
   - 检查开发环境 `llm_api_config` 表是否有数据
   - 如果没有数据，删除该表

3. **执行 Migration 044**
   - 在生产环境执行，确保神煞解读表编码正确

