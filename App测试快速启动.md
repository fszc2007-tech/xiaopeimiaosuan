# App 测试快速启动指南

## 🚀 一键启动（3 步）

### Step 1: 启动后端（如果还没启动）

```bash
cd /Users/gaoxuxu/Desktop/小佩APP/core
npm run dev
```

✅ **后端已在运行**（已自动重启以应用 CORS 配置）

---

### Step 2: 启动 App 前端

```bash
cd /Users/gaoxuxu/Desktop/小佩APP/app
npx expo start --clear
```

**等待出现二维码** 📱

---

### Step 3: 在手机上连接

#### iOS（iPhone）
1. 打开**相机 App**
2. 扫描终端中的**二维码**
3. 点击通知横幅 → 自动打开 Expo Go
4. 等待加载（首次 1-2 分钟）

#### Android
1. 打开**Expo Go App**
2. 点击 **"Scan QR code"**
3. 扫描终端中的**二维码**
4. 等待加载

---

## ⚙️ 已完成的配置

✅ **环境变量**：`app/.env`
```
EXPO_PUBLIC_API_BASE_URL=http://10.89.148.75:3000
```

✅ **CORS 配置**：已允许
- Expo Go (`exp://*`)
- 局域网 IP (`10.x.x.x`, `192.168.x.x`)

✅ **后端服务**：运行在 `http://10.89.148.75:3000`

---

## 🔧 如果遇到问题

### 问题 1: 无法扫描二维码

**解决方案**：
```bash
# 使用 tunnel 模式（推荐）
npx expo start --tunnel

# 或使用 LAN 模式
npx expo start --lan
```

---

### 问题 2: 无法连接 API

**检查清单**：
- [ ] 手机和电脑在同一 Wi-Fi
- [ ] 后端正在运行（`curl http://localhost:3000/health`）
- [ ] 防火墙允许端口 3000

**测试连接**：
```bash
# 在手机上用浏览器访问
http://10.89.148.75:3000/health

# 应该返回: {"status":"ok"}
```

---

### 问题 3: CORS 错误

**已自动修复** ✅

如果仍有问题，检查后端日志：
```bash
tail -f /tmp/core-restart-app.log
```

---

## 📱 测试功能

### 1. 登录/注册
- 选择地区（CN/HK）
- 输入手机号（测试阶段可不验证）
- 输入密码（至少 6 位）
- 点击登录

### 2. 手动排盘
- 点击底部"排盤"
- 填写出生信息
- 生成命盘

### 3. AI 聊天
- 点击底部"小佩"
- 输入问题
- 查看 AI 回复

### 4. 命盘详情
- 从"檔案"进入
- 查看命盘列表
- 点击查看详情

---

## 🎯 开发快捷键

在 Expo 开发服务器运行时：

| 按键 | 功能 |
|------|------|
| `r` | 重新加载 App |
| `m` | 打开开发菜单 |
| `?` | 显示所有命令 |

---

**现在可以开始测试了！** 🎉

