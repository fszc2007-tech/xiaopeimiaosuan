# é‡è¦æ›´æ–°ï¼šæµå¼å“åº”ä¼˜å…ˆç­–ç•¥

**æ›´æ–°æ—¶é—´**: 2024-11-18  
**å½±å“èŒƒå›´**: æ‰€æœ‰ LLM Provider

---

## ğŸ“¢ æ›´æ–°è¯´æ˜

### å˜æ›´å†…å®¹

æ‰€æœ‰ LLM Providerï¼ˆDeepSeekã€ChatGPTã€Qwenï¼‰ç°åœ¨**ä»…æ”¯æŒæµå¼å“åº”**ï¼š

1. âœ… **æµå¼å“åº”ï¼ˆchatStreamï¼‰**ï¼šæ¨èä½¿ç”¨ï¼Œå®æ—¶è¿”å›å†…å®¹
2. âš ï¸ **éæµå¼å“åº”ï¼ˆchatï¼‰**ï¼šå·²åºŸå¼ƒï¼Œä¼šè‡ªåŠ¨è½¬ä¸ºæµå¼è°ƒç”¨

### åŸå› 

- é¿å…åæœŸå¼€å‘æ—¶è¯¯è°ƒç”¨éæµå¼ API å¯¼è‡´é—®é¢˜
- ç»Ÿä¸€ä½¿ç”¨æµå¼å“åº”ï¼Œæå‡ç”¨æˆ·ä½“éªŒ
- ç®€åŒ–ä»£ç ç»´æŠ¤ï¼Œé¿å…ä¸¤å¥—é€»è¾‘

---

## ğŸ”§ æŠ€æœ¯ç»†èŠ‚

### DeepSeek æ¨¡å¼æ”¯æŒ

```typescript
// æ ‡å‡†æ¨¡å¼ï¼ˆå¿«é€Ÿã€é«˜æ•ˆï¼‰
config.thinkingMode = false;  // ä½¿ç”¨ deepseek-chat

// Thinking æ¨¡å¼ï¼ˆæ·±åº¦æ¨ç†ï¼‰
config.thinkingMode = true;   // ä½¿ç”¨ deepseek-reasoner
```

### è‡ªåŠ¨å…¼å®¹

å¦‚æœä¸å°å¿ƒè°ƒç”¨äº† `chat()` æ–¹æ³•ï¼š
```typescript
// ä¼šè‡ªåŠ¨è½¬ä¸ºæµå¼è°ƒç”¨å¹¶è¿”å›å®Œæ•´ç»“æœ
const response = await provider.chat(request);
// âš ï¸ æ§åˆ¶å°ä¼šè¾“å‡ºè­¦å‘Šï¼šchat() is deprecated. Use chatStream() instead.
```

---

## ğŸ“ ä½¿ç”¨ç¤ºä¾‹

### âœ… æ¨èç”¨æ³•ï¼ˆæµå¼ï¼‰

```typescript
import * as aiService from '../modules/ai/aiService';

// æµå¼è°ƒç”¨
for await (const chunk of aiService.chatStream({
  model: 'deepseek',
  request: { messages, temperature: 0.7 },
})) {
  if (!chunk.done) {
    process.stdout.write(chunk.content); // å®æ—¶è¾“å‡º
  }
}
```

### âš ï¸ åºŸå¼ƒç”¨æ³•ï¼ˆéæµå¼ï¼‰

```typescript
// ä¸æ¨èï¼Œä¼šè‡ªåŠ¨è½¬ä¸ºæµå¼
const response = await aiService.chat({
  model: 'deepseek',
  request: { messages, temperature: 0.7 },
});
// æ§åˆ¶å°è­¦å‘Šï¼šchat() is deprecated. Use chatStream() instead.
```

---

## ğŸ¯ API æ–‡æ¡£è‡ªåŠ¨åŒ–

æ–°å¢ **API æ–‡æ¡£è‡ªåŠ¨ç”Ÿæˆç³»ç»Ÿ**ï¼š

### åŠŸèƒ½
1. âœ… ä»ä»£ç è‡ªåŠ¨æå– API ä¿¡æ¯
2. âœ… ç”Ÿæˆ Markdown æ ¼å¼æ–‡æ¡£
3. âœ… ä¿æŒæ–‡æ¡£ä¸ä»£ç åŒæ­¥

### ä½¿ç”¨æ–¹æ³•

#### 1. æ³¨å†Œ API
åœ¨è·¯ç”±æ–‡ä»¶ä¸­ä½¿ç”¨ `registerApi()`ï¼š

```typescript
import { registerApi } from '../utils/apiDocs';

registerApi({
  method: 'POST',
  path: '/api/v1/auth/login',
  description: 'ç”¨æˆ·ç™»å½•',
  auth: false,
  request: { body: { phone: 'æ‰‹æœºå·', code: 'éªŒè¯ç ' } },
  response: { 
    success: { token: 'JWT Token', user: {} },
    error: ['INVALID_CREDENTIALS'],
  },
});
```

#### 2. ç”Ÿæˆæ–‡æ¡£

```bash
npm run docs:generate
```

è‡ªåŠ¨ç”Ÿæˆ `APIæ¥å£æ–‡æ¡£-è‡ªåŠ¨ç”Ÿæˆ.md`

### ä¼˜åŠ¿
- **ä»£ç å³æ–‡æ¡£**ï¼šä¿®æ”¹ API æ—¶è‡ªç„¶ä¼šæ›´æ–°æ–‡æ¡£
- **è‡ªåŠ¨åŒ–**ï¼šä¸€é”®ç”Ÿæˆå®Œæ•´æ–‡æ¡£
- **æ ¼å¼ç»Ÿä¸€**ï¼šæ‰€æœ‰ API éµå¾ªç›¸åŒæ ¼å¼

---

## ğŸ“š ç›¸å…³æ–‡ä»¶

- `core/src/utils/apiDocs.ts` - API æ–‡æ¡£å·¥å…·
- `core/scripts/generateApiDocs.ts` - æ–‡æ¡£ç”Ÿæˆè„šæœ¬
- `core/APIæ–‡æ¡£è‡ªåŠ¨åŒ–è¯´æ˜.md` - è¯¦ç»†ä½¿ç”¨è¯´æ˜
- `core/APIæ¥å£æ–‡æ¡£-è‡ªåŠ¨ç”Ÿæˆ.md` - è‡ªåŠ¨ç”Ÿæˆçš„æ–‡æ¡£ï¼ˆè¿è¡Œåï¼‰

---

## âœ… å·²å®Œæˆ

- âœ… DeepSeek æ”¯æŒä¸¤ç§æ¨¡å¼ï¼ˆchat + reasonerï¼‰
- âœ… æ‰€æœ‰ Provider ä»…æ”¯æŒæµå¼å“åº”
- âœ… è‡ªåŠ¨å…¼å®¹éæµå¼è°ƒç”¨ï¼ˆè½¬ä¸ºæµå¼ï¼‰
- âœ… API æ–‡æ¡£è‡ªåŠ¨ç”Ÿæˆç³»ç»Ÿ
- âœ… è®¤è¯æ¨¡å— API å·²æ³¨å†Œ

---

## ğŸ“‹ å¾…å®Œæˆ

- [ ] å‘½ç›˜æ¨¡å— API æ³¨å†Œ
- [ ] è§£è¯»æ¨¡å— API æ³¨å†Œ
- [ ] ç”Ÿæˆå®Œæ•´ API æ–‡æ¡£

---

**é‡è¦æé†’**: ä»¥åå¼€å‘æ—¶ï¼Œè¯·ç»Ÿä¸€ä½¿ç”¨ `chatStream()` è€Œé `chat()`ï¼

