# iOS æ„å»ºé—®é¢˜è§£å†³æ–¹æ¡ˆ

## âœ… é—®é¢˜å·²è§£å†³ï¼

### é—®é¢˜åŸå› 

1. **åº”ç”¨åç§°ä¸åŒ¹é…**
   - Detox é…ç½®æœŸæœ›ï¼š`å°ä½©å¦™ç®—.app`
   - å®é™…æ„å»ºåç§°ï¼š`app.app`
   - Expo ä½¿ç”¨é¡¹ç›® slug ä½œä¸ºåº”ç”¨åç§°

2. **æ„å»ºè·¯å¾„ä¸åŒ¹é…**
   - Detox é…ç½®æœŸæœ›ï¼š`ios/build/Build/Products/...`
   - Expo å®é™…ä½¿ç”¨ï¼š`~/Library/Developer/Xcode/DerivedData/...`
   - Expo é»˜è®¤ä½¿ç”¨ DerivedDataï¼Œä¸æ˜¯é¡¹ç›®å†…çš„ build ç›®å½•

3. **Workspace å’Œ Scheme åç§°**
   - Detox é…ç½®æœŸæœ›ï¼š`å°ä½©å¦™ç®—.xcworkspace` å’Œ `å°ä½©å¦™ç®—`
   - å®é™…åç§°ï¼š`app.xcworkspace` å’Œ `app`

## âœ… å·²ä¿®å¤

### 1. æ›´æ–° Detox é…ç½®
- âœ… `detox.config.js` - å·²æ›´æ–°ä¸ºæ­£ç¡®çš„åº”ç”¨åç§°å’Œè·¯å¾„
- âœ… `.detoxrc.js` - å·²æ›´æ–°ä¸ºæ­£ç¡®çš„åº”ç”¨åç§°å’Œè·¯å¾„

### 2. åˆ›å»ºç¬¦å·é“¾æ¥
- âœ… å·²åˆ›å»ºç¬¦å·é“¾æ¥ï¼š`ios/build/Build/Products/Debug-iphonesimulator/app.app`
- âœ… æŒ‡å‘å®é™…æ„å»ºä½ç½®ï¼š`~/Library/Developer/Xcode/DerivedData/.../app.app`

### 3. æ›´æ–°ç›‘æ§è„šæœ¬
- âœ… `scripts/monitor-build-and-test.js` - æ”¯æŒæ£€æŸ¥ DerivedData
- âœ… `scripts/auto-build-and-test.js` - æ”¯æŒæ£€æŸ¥ DerivedData

## ğŸ“Š å½“å‰çŠ¶æ€

### æ„å»ºçŠ¶æ€
- âœ… **æ„å»ºæˆåŠŸ** - åº”ç”¨å·²æ„å»ºå¹¶å®‰è£…åˆ°æ¨¡æ‹Ÿå™¨
- âœ… **åº”ç”¨è¿è¡Œä¸­** - æ­£åœ¨ç­‰å¾… Metro bundler

### æµ‹è¯•çŠ¶æ€
- â³ **æµ‹è¯•åº”ç”¨æ„å»ºä¸­** - Detox æ­£åœ¨æ„å»ºæµ‹è¯•åº”ç”¨
- â³ **æµ‹è¯•å³å°†è¿è¡Œ** - æ„å»ºå®Œæˆåè‡ªåŠ¨è¿è¡Œ

## ğŸš€ è¿è¡Œæµ‹è¯•

### æ–¹æ³• 1: ç­‰å¾…è‡ªåŠ¨æµ‹è¯•ï¼ˆæ¨èï¼‰
ç›‘æ§è„šæœ¬ä¼šè‡ªåŠ¨è¿è¡Œæµ‹è¯•ï¼Œåªéœ€ç­‰å¾…å³å¯ã€‚

### æ–¹æ³• 2: æ‰‹åŠ¨è¿è¡Œæµ‹è¯•
```bash
cd /Users/gaoxuxu/Desktop/å°ä½©APP/app

# æ„å»ºæµ‹è¯•åº”ç”¨
npm run test:e2e:ios:build

# è¿è¡Œæµ‹è¯•
npm run test:e2e:ios
```

## ğŸ“ é…ç½®è¯´æ˜

### Detox é…ç½®è¦ç‚¹

1. **åº”ç”¨åç§°**: ä½¿ç”¨ `app.app`ï¼ˆä¸æ˜¯ `å°ä½©å¦™ç®—.app`ï¼‰
2. **Workspace**: ä½¿ç”¨ `app.xcworkspace`ï¼ˆä¸æ˜¯ `å°ä½©å¦™ç®—.xcworkspace`ï¼‰
3. **Scheme**: ä½¿ç”¨ `app`ï¼ˆä¸æ˜¯ `å°ä½©å¦™ç®—`ï¼‰
4. **æ„å»ºè·¯å¾„**: ä½¿ç”¨ `ios/build/Build/Products/...`ï¼ˆé€šè¿‡ç¬¦å·é“¾æ¥ï¼‰

### Expo æ„å»ºè¯´æ˜

Expo ä½¿ç”¨ä»¥ä¸‹é»˜è®¤è®¾ç½®ï¼š
- **åº”ç”¨åç§°**: ä½¿ç”¨é¡¹ç›® slugï¼ˆ`xiaopei-app` â†’ `app`ï¼‰
- **æ„å»ºè·¯å¾„**: ä½¿ç”¨ Xcode DerivedData
- **Workspace**: ä½¿ç”¨é¡¹ç›®åç§°ï¼ˆ`app`ï¼‰

## âš ï¸ æ³¨æ„äº‹é¡¹

1. **ç¬¦å·é“¾æ¥**: å¦‚æœé‡æ–°æ„å»ºï¼Œå¯èƒ½éœ€è¦é‡æ–°åˆ›å»ºç¬¦å·é“¾æ¥
2. **DerivedData**: Expo å¯èƒ½ä½¿ç”¨ä¸åŒçš„ DerivedData ç›®å½•
3. **åº”ç”¨åç§°**: å¦‚æœéœ€è¦æ›´æ”¹ï¼Œéœ€è¦ä¿®æ”¹ Xcode é¡¹ç›®è®¾ç½®

## ğŸ”§ å¦‚æœé‡åˆ°é—®é¢˜

### é‡æ–°åˆ›å»ºç¬¦å·é“¾æ¥
```bash
cd /Users/gaoxuxu/Desktop/å°ä½©APP/app
rm -rf ios/build/Build/Products/Debug-iphonesimulator/app.app
mkdir -p ios/build/Build/Products/Debug-iphonesimulator
ln -sf ~/Library/Developer/Xcode/DerivedData/app-*/Build/Products/Debug-iphonesimulator/app.app ios/build/Build/Products/Debug-iphonesimulator/app.app
```

### æŸ¥æ‰¾å®é™…æ„å»ºä½ç½®
```bash
find ~/Library/Developer/Xcode/DerivedData/app-* -name "app.app" -type d
```

---

**ä¿®å¤æ—¶é—´**: 2025-11-19 13:49  
**çŠ¶æ€**: âœ… é—®é¢˜å·²è§£å†³ï¼Œæµ‹è¯•è¿›è¡Œä¸­

