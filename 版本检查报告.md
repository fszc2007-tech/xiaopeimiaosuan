# ç‰ˆæœ¬æ£€æŸ¥æŠ¥å‘Š

**æ£€æŸ¥æ—¶é—´**: 2025-12-24  
**Git æäº¤**: `938c675`  
**æ„å»ºç‰ˆæœ¬**: 1.0.3 (versionCode: 3)

---

## âœ… Git æäº¤ç‰ˆæœ¬æ£€æŸ¥

### æäº¤ä¿¡æ¯
- **æäº¤ ID**: `938c675cae72f9035744ea91d772cc54116ff666`
- **æäº¤æ—¶é—´**: 2025-12-24 20:14:54
- **æäº¤ä¿¡æ¯**: "fix: ä¿®å¤ç”Ÿäº§ç¯å¢ƒé—®é¢˜"

### æäº¤çš„æ–‡ä»¶ï¼ˆ9ä¸ªæ–‡ä»¶ï¼‰
1. âœ… `app/app.json` - ç‰ˆæœ¬å·æ›´æ–°
2. âœ… `app/src/components/auth/GoogleLoginSheet.tsx` - åä¸º Mate 40 é€‚é…
3. âœ… `app/src/components/auth/GoogleSignInButton.tsx` - Google ç™»å½•è¯Šæ–­
4. âœ… `app/src/config/env.ts` - ç¯å¢ƒå˜é‡è¯Šæ–­
5. âœ… `app/src/config/google.ts` - Google é…ç½®è¯Šæ–­
6. âœ… `app/src/screens/Auth/PolicyViewerScreen.tsx` - PDF åŠ è½½ä¿®å¤
7. âœ… `app/src/services/api/apiClient.ts` - API å®¢æˆ·ç«¯è¯Šæ–­
8. âœ… `app/src/services/api/authService.ts` - çŸ­ä¿¡è¯·æ±‚è¯Šæ–­
9. âœ… `app/src/types/user.ts` - ç±»å‹å®šä¹‰ä¿®å¤

**ç»Ÿè®¡**: 165 è¡Œæ–°å¢ï¼Œ44 è¡Œåˆ é™¤

---

## âœ… ç‰ˆæœ¬å·æ£€æŸ¥

### app.json ç‰ˆæœ¬å·ï¼ˆGit æäº¤ä¸­ï¼‰
```json
"version": "1.0.3"
"versionCode": 3
```
**çŠ¶æ€**: âœ… æ­£ç¡®

### å½“å‰å·¥ä½œåŒºç‰ˆæœ¬å·
```json
"version": "1.0.3"
"versionCode": 3
```
**çŠ¶æ€**: âœ… ä¸æäº¤ä¸€è‡´

---

## âœ… å…³é”®ä»£ç æ£€æŸ¥ï¼ˆGit æäº¤ä¸­ï¼‰

### 1. ç¯å¢ƒå˜é‡è¯Šæ–­æ—¥å¿—

**æ–‡ä»¶**: `app/src/config/env.ts`

**æäº¤å†…å®¹**:
```typescript
console.warn('[ENV DIAGNOSTIC] ğŸ” API_BASE_URL:', ENV.API_BASE_URL);
console.warn('[ENV DIAGNOSTIC] ğŸ” EXPO_PUBLIC_API_BASE_URL:', process.env.EXPO_PUBLIC_API_BASE_URL || 'âŒ æœªè®¾ç½®');
console.warn('[ENV DIAGNOSTIC] ğŸ” APP_ENV:', ENV.APP_ENV);
```
**çŠ¶æ€**: âœ… å·²æäº¤

---

### 2. PDF åŠ è½½ä¿®å¤

**æ–‡ä»¶**: `app/src/screens/Auth/PolicyViewerScreen.tsx`

**æäº¤å†…å®¹**:
```typescript
const pdfUrl = rawPdfUrl;  // ç›´æ¥ä½¿ç”¨ PDF URLï¼Œä¸ä½¿ç”¨ Google Docs Viewer
```
**çŠ¶æ€**: âœ… å·²æäº¤

---

### 3. åä¸º Mate 40 é€‚é…

**æ–‡ä»¶**: `app/src/components/auth/GoogleLoginSheet.tsx`

**æäº¤å†…å®¹**:
```typescript
const insets = useSafeAreaInsets();
const sheetHeight = Math.min(baseHeight, screenHeight * 0.5);
// ...
height: sheetHeight,
```
**çŠ¶æ€**: âœ… å·²æäº¤

---

### 4. çŸ­ä¿¡è¯·æ±‚å‚æ•°

**æ–‡ä»¶**: `app/src/types/user.ts`

**æäº¤å†…å®¹**:
```typescript
export interface RequestOtpRequest {
  region?: 'cn' | 'hk' | 'mo' | 'tw' | 'intl';
  countryCode?: string;
}
```
**çŠ¶æ€**: âœ… å·²æäº¤

---

## âœ… EAS æ„å»ºé…ç½®æ£€æŸ¥

### eas.json ç”Ÿäº§ç¯å¢ƒé…ç½®

```json
"production": {
  "env": {
    "EXPO_PUBLIC_ENV": "production",
    "EXPO_PUBLIC_API_BASE_URL": "https://xiaopei-core-343578696044.asia-east2.run.app",
    "EXPO_PUBLIC_APP_ENV_HEADER": "production"
  }
}
```

**æ£€æŸ¥é¡¹**:
- âœ… `EXPO_PUBLIC_ENV`: "production" - æ­£ç¡®
- âœ… `EXPO_PUBLIC_API_BASE_URL`: "https://xiaopei-core-343578696044.asia-east2.run.app" - æ­£ç¡®
- âœ… `EXPO_PUBLIC_APP_ENV_HEADER`: "production" - æ­£ç¡®

**çŠ¶æ€**: âœ… é…ç½®æ­£ç¡®

---

## âœ… æ„å»ºä¿¡æ¯

### æœ€æ–°æ„å»º
- **æ„å»º ID**: `d234c9e5-a0f0-47d2-aef8-966600be51f6`
- **ç‰ˆæœ¬**: 1.0.3 (versionCode: 3)
- **APK**: https://expo.dev/artifacts/eas/rXvT6CsutxYoSaUc26ymgh.apk
- **æ„å»ºæ—¶é—´**: åˆšåˆšå®Œæˆ
- **ç¼“å­˜**: å·²æ¸…é™¤ï¼ˆä½¿ç”¨äº† `--clear-cache`ï¼‰

---

## ğŸ“Š æ£€æŸ¥ç»“æœæ€»ç»“

### âœ… æäº¤ç‰ˆæœ¬
- **ç‰ˆæœ¬å·**: 1.0.3 (versionCode: 3) âœ…
- **æ‰€æœ‰ä¿®æ”¹**: å·²æäº¤åˆ° Git âœ…
- **å…³é”®ä»£ç **: å…¨éƒ¨åŒ…å«åœ¨æäº¤ä¸­ âœ…

### âœ… æ„å»ºç‰ˆæœ¬
- **ç‰ˆæœ¬å·**: 1.0.3 (versionCode: 3) âœ…
- **ç¯å¢ƒå˜é‡**: é…ç½®æ­£ç¡® âœ…
- **API_BASE_URL**: https://xiaopei-core-343578696044.asia-east2.run.app âœ…

### âœ… ä»£ç å†…å®¹
- **PDF åŠ è½½**: ç›´æ¥ä½¿ç”¨ PDF URL âœ…
- **çŸ­ä¿¡å‚æ•°**: region å’Œ countryCode æ”¯æŒ âœ…
- **Google ç™»å½•**: è¯Šæ–­æ—¥å¿—å·²æ·»åŠ  âœ…
- **åä¸º Mate 40**: SafeAreaView å’ŒåŠ¨æ€é«˜åº¦ âœ…
- **ç¯å¢ƒå˜é‡è¯Šæ–­**: æ—¥å¿—å·²æ·»åŠ  âœ…

---

## ğŸ¯ ç»“è®º

**æ‰€æœ‰æ£€æŸ¥é¡¹å‡é€šè¿‡** âœ…

1. âœ… Git æäº¤ç‰ˆæœ¬æ­£ç¡®ï¼ˆ1.0.3, versionCode: 3ï¼‰
2. âœ… æ„å»ºç‰ˆæœ¬æ­£ç¡®ï¼ˆ1.0.3, versionCode: 3ï¼‰
3. âœ… æ‰€æœ‰å…³é”®ä»£ç å·²æäº¤
4. âœ… EAS é…ç½®æ­£ç¡®
5. âœ… ç¯å¢ƒå˜é‡é…ç½®æ­£ç¡®

**æœ¬æ¬¡æ„å»ºåº”è¯¥åŒ…å«æ‰€æœ‰ä¿®å¤**ã€‚

---

## ğŸ“ éªŒè¯æ–¹æ³•

å®‰è£… APK åï¼ŒéªŒè¯ï¼š

1. **ç‰ˆæœ¬å·**: App è®¾ç½®ä¸­åº”æ˜¾ç¤º 1.0.3
2. **ç¯å¢ƒå˜é‡**: `adb logcat | grep "ENV DIAGNOSTIC"` åº”æ˜¾ç¤ºæ­£ç¡®çš„ API_BASE_URL
3. **ç”¨æˆ·åè®®**: åº”èƒ½åŠ è½½ PDF æˆ–æ˜¾ç¤ºé”™è¯¯æç¤º
4. **çŸ­ä¿¡**: åº”èƒ½æ­£å¸¸å‘é€
5. **Google ç™»å½•**: å¼¹çª—é«˜åº¦åº”é€‚é…
6. **åä¸º Mate 40**: å®‰å…¨åŒºåŸŸåº”æ­£ç¡®å¤„ç†

