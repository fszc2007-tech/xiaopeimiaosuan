# è®¢é˜…çŠ¶æ€åŒæ­¥ä¿®å¤æŠ¥å‘Š

## é—®é¢˜æè¿°

ç”¨æˆ·è®¢é˜…æˆåŠŸåï¼Œè¿”å›"æˆ‘çš„"é¡µé¢æ—¶ï¼Œä¼šå‘˜çŠ¶æ€æ˜¾ç¤ºä»ç„¶æ˜¯"å…è²»ç”¨æˆ¶"ï¼Œæ²¡æœ‰æ›´æ–°ä¸ºä¼šå‘˜çŠ¶æ€ã€‚

## æ ¹æœ¬åŸå› åˆ†æ

1. **çŠ¶æ€æ›´æ–°ç¼ºå¤±**ï¼šè®¢é˜…æˆåŠŸåæ²¡æœ‰æ›´æ–° `authStore` ä¸­çš„ç”¨æˆ·ä¼šå‘˜çŠ¶æ€
2. **åŒ Store ä¸ä¸€è‡´**ï¼šé¡¹ç›®ä¸­æœ‰ `authStore` å’Œ `proStore` ä¸¤ä¸ª store ç®¡ç†ä¼šå‘˜çŠ¶æ€ï¼Œä½†è®¢é˜…æˆåŠŸååªæ›´æ–°äº†ä¸€ä¸ª
3. **MeScreen æ•°æ®è¦†ç›–**ï¼šMeScreen ä»åç«¯è·å–æ•°æ®åï¼Œæ²¡æœ‰åŒæ­¥æ›´æ–° `authStore`ï¼Œå¯èƒ½å¯¼è‡´æ—§æ•°æ®è¦†ç›–æ–°çŠ¶æ€

## ä¿®å¤æ–¹æ¡ˆ

### 1ï¸âƒ£ è®¢é˜…æˆåŠŸååŒæ­¥æ›´æ–°çŠ¶æ€

**æ–‡ä»¶**ï¼š`app/src/screens/ProSubscription/ProSubscriptionScreen.tsx`

**ä¿®æ”¹å†…å®¹**ï¼š
```typescript
// è°ƒç”¨è®¢é˜…æ¥å£
const response = await proService.subscribe({ plan: selectedPlan });

// ğŸ”¥ æ›´æ–° authStore
updateUser({
  isPro: response.user.isPro,
  proExpiresAt: response.user.proExpiresAt || undefined,
  proPlan: response.user.proPlan as 'monthly' | 'quarterly' | 'yearly' | undefined,
});

// ğŸ”¥ åŒæ—¶æ›´æ–° proStoreï¼Œç¡®ä¿ä¸¤ä¸ª store çŠ¶æ€ä¸€è‡´
setProStatus(
  response.user.isPro,
  response.user.proPlan as 'monthly' | 'quarterly' | 'yearly' | undefined,
  response.user.proExpiresAt || undefined
);
```

### 2ï¸âƒ£ MeScreen åŒæ­¥çŠ¶æ€åˆ° authStore

**æ–‡ä»¶**ï¼š`app/src/screens/Me/MeScreen.tsx`

**ä¿®æ”¹å†…å®¹**ï¼š
```typescript
// ä»åç«¯è·å–ç”¨æˆ·ä¿¡æ¯
const userInfo = await authApi.getMe();

// è®¾ç½®æœ¬åœ° profile
setProfile(profileData);

// ğŸ”¥ åŒæ­¥æ›´æ–° authStoreï¼Œç¡®ä¿ä¼šå‘˜çŠ¶æ€æ˜¾ç¤ºä¸€è‡´
updateUser({
  isPro: userInfo.isPro,
  proExpiresAt: userInfo.proExpiresAt,
  proPlan: userInfo.proType as 'monthly' | 'quarterly' | 'yearly' | undefined,
});
```

### 3ï¸âƒ£ ä¿®å¤ User ç±»å‹å®šä¹‰

**æ–‡ä»¶**ï¼š`app/src/types/user.ts`

**ä¿®æ”¹å†…å®¹**ï¼š
```typescript
// ä¿®æ”¹å‰
proPlan?: 'yearly' | 'monthly' | 'lifetime';

// ä¿®æ”¹åï¼ˆå¢åŠ  quarterly é€‰é¡¹ï¼‰
proPlan?: 'monthly' | 'quarterly' | 'yearly' | 'lifetime';
```

### 4ï¸âƒ£ æ·»åŠ è°ƒè¯•æ—¥å¿—

åœ¨å…³é”®ä½ç½®æ·»åŠ  console.logï¼Œæ–¹ä¾¿è¿½è¸ªçŠ¶æ€å˜åŒ–ï¼š
- è®¢é˜…æˆåŠŸåçš„çŠ¶æ€æ›´æ–°
- MeScreen æ•°æ®è·å–å’ŒåŒæ­¥
- ä¼šå‘˜çŠ¶æ€å˜åŒ–ç›‘å¬

## æ•°æ®æµä¿è¯

```
è®¢é˜…æˆåŠŸ 
  â†“
æ›´æ–° authStore.user (isPro, proExpiresAt, proPlan)
  â†“
æ›´æ–° proStore (isPro, plan, expiresAt)
  â†“
MeScreen è‡ªåŠ¨å“åº” authStore å˜åŒ–
  â†“
æ˜¾ç¤ºæ­£ç¡®çš„ä¼šå‘˜çŠ¶æ€ï¼ˆ"å°ä½© Pro Â· è‡³ {æ—¥æœŸ}"ï¼‰
```

## æµ‹è¯•æ­¥éª¤

1. **è®¢é˜…æµç¨‹æµ‹è¯•**ï¼š
   - ä»¥éä¼šå‘˜èº«ä»½ç™»å½•
   - è¿›å…¥è®¢é˜…é¡µé¢ â†’ é€‰æ‹©æ–¹æ¡ˆ â†’ ç‚¹å‡»è®¢é˜…
   - åº”æ˜¾ç¤º"æ­å–œæ‚¨æˆç‚ºå°ä½©æœƒå“¡ï¼"å¯¹è¯æ¡†
   - ç‚¹å‡»"å‰å¾€æœƒå“¡ä¸­å¿ƒ" â†’ è·³è½¬åˆ°ä¼šå‘˜ä¸­å¿ƒ
   - ä¼šå‘˜ä¸­å¿ƒåº”æ˜¾ç¤ºæ­£ç¡®çš„ä¼šå‘˜çŠ¶æ€

2. **çŠ¶æ€æ˜¾ç¤ºæµ‹è¯•**ï¼š
   - è¿”å›"æˆ‘çš„"é¡µé¢
   - é¡¶éƒ¨åº”æ˜¾ç¤º"å°ä½© Pro Â· è‡³ {æ—¥æœŸ}"ï¼ˆå¸¦çš‡å† å›¾æ ‡ï¼‰
   - ä¸åº”å†æ˜¾ç¤º"å…è²»ç”¨æˆ¶"

3. **æŒä¹…åŒ–æµ‹è¯•**ï¼š
   - å…³é—­å¹¶é‡æ–°æ‰“å¼€ App
   - ä¼šå‘˜çŠ¶æ€åº”è¯¥ä¿æŒï¼ˆæ˜¾ç¤º"å°ä½© Pro Â· è‡³ {æ—¥æœŸ}"ï¼‰

## æ¶‰åŠæ–‡ä»¶

1. `app/src/screens/ProSubscription/ProSubscriptionScreen.tsx` - è®¢é˜…é¡µé¢
2. `app/src/screens/Me/MeScreen.tsx` - æˆ‘çš„é¡µé¢
3. `app/src/types/user.ts` - User ç±»å‹å®šä¹‰
4. `app/src/store/authStore.ts` - è®¤è¯çŠ¶æ€ç®¡ç†ï¼ˆæ— ä¿®æ”¹ï¼Œä»…ä½¿ç”¨ï¼‰
5. `app/src/store/proStore.ts` - Pro çŠ¶æ€ç®¡ç†ï¼ˆæ— ä¿®æ”¹ï¼Œä»…ä½¿ç”¨ï¼‰

## å…¶ä»–ä¼˜åŒ–

1. âœ… è®¢é˜…æˆåŠŸå¯¹è¯æ¡†æ–‡æ¡ˆä¼˜åŒ–ï¼šå»æ‰"ç¾åœ¨å¯ä»¥äº«å—æ¯å¤© 100 æ¬¡ AI è§£è®€äº†ã€‚"
2. âœ… éä¼šå‘˜çŠ¶æ€æ˜¾ç¤ºï¼šä»"å…è²»ç‰ˆ"æ”¹ä¸º"å…è²»ç”¨æˆ¶"
3. âœ… ç¡®è®¤æŒ‰é’®æ–‡æ¡ˆï¼šæ”¹ä¸º"å‰å¾€æœƒå“¡ä¸­å¿ƒ"

## æ³¨æ„äº‹é¡¹

1. **åŒ Store ç®¡ç†**ï¼šé¡¹ç›®ä¸­æœ‰ `authStore` å’Œ `proStore` ä¸¤ä¸ª store ç®¡ç†ä¼šå‘˜çŠ¶æ€ï¼Œéœ€è¦ç¡®ä¿ä¸¤è€…åŒæ­¥æ›´æ–°
2. **åç«¯çŠ¶æ€åŒæ­¥**ï¼šè®¢é˜…æ¥å£åº”è¯¥åŒæ­¥æ›´æ–°æ•°æ®åº“ï¼Œç¡®ä¿åç»­ API è°ƒç”¨è¿”å›æœ€æ–°çŠ¶æ€
3. **æŒä¹…åŒ–æœºåˆ¶**ï¼šauthStore ä½¿ç”¨ Zustand persist ä¸­é—´ä»¶ï¼ŒçŠ¶æ€ä¼šè‡ªåŠ¨ä¿å­˜åˆ° AsyncStorage

## ä¿®å¤æ—¶é—´

2025-12-03

## ä¿®å¤äººå‘˜

AI Assistant (Claude)

