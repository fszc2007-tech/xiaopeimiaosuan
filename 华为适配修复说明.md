# åä¸ºé€‚é…ä¿®å¤è¯´æ˜

## ğŸ”´ é—®é¢˜åˆ†æ

åä¸º Mate 40 é€‚é…æœªç”Ÿæ•ˆçš„æ ¹æœ¬åŸå› ï¼š

### é—®é¢˜ 1: Modal å†… SafeAreaInsets å¯èƒ½æ— æ³•æ­£ç¡®è·å–

**åŸå› **ï¼š
- `useSafeAreaInsets()` åœ¨ `Modal` ç»„ä»¶å†…å¯èƒ½æ— æ³•æ­£ç¡®è·å–å®‰å…¨åŒºåŸŸå€¼
- Modal æ˜¯ç‹¬ç«‹çš„æ¸²æŸ“æ ‘ï¼Œå¯èƒ½ä¸åœ¨ SafeAreaProvider çš„ä¸Šä¸‹æ–‡ä¸­

**è§£å†³æ–¹æ¡ˆ**ï¼š
- åœ¨ Modal å†…æ·»åŠ  `SafeAreaView` ç»„ä»¶ï¼Œç¡®ä¿èƒ½æ­£ç¡®è·å–å®‰å…¨åŒºåŸŸ
- ä½¿ç”¨ `edges={[]}` ç¦ç”¨é»˜è®¤çš„ paddingï¼Œæ‰‹åŠ¨æ§åˆ¶å¸ƒå±€

### é—®é¢˜ 2: é«˜åº¦è®¡ç®—é€»è¾‘å¯èƒ½ä¸å¤Ÿç²¾ç¡®

**å½“å‰é€»è¾‘**ï¼š
```typescript
const calculatedHeight = Math.max(minSheetHeight, maxSheetHeight - insets.bottom);
const sheetHeight = Math.min(baseHeight, calculatedHeight);
```

**å¯èƒ½çš„é—®é¢˜**ï¼š
- å¦‚æœ `insets.bottom` ä¸º 0 æˆ–å¾ˆå°ï¼Œè®¡ç®—å¯èƒ½ä¸å‡†ç¡®
- åä¸º Mate 40 çš„åº•éƒ¨å¯¼èˆªæ é«˜åº¦å¯èƒ½æ²¡æœ‰è¢«æ­£ç¡®è¯†åˆ«

## âœ… ä¿®å¤æ–¹æ¡ˆ

### ä¿®å¤ 1: åœ¨ Modal å†…æ·»åŠ  SafeAreaView

```typescript
<Modal>
  <SafeAreaView style={{ flex: 1 }} edges={[]}>
    {/* å†…å®¹ */}
  </SafeAreaView>
</Modal>
```

### ä¿®å¤ 2: æ·»åŠ è°ƒè¯•æ—¥å¿—

æ·»åŠ äº†è¯¦ç»†çš„è°ƒè¯•æ—¥å¿—ï¼Œè®°å½•ï¼š
- `screenHeight`: å±å¹•é«˜åº¦
- `insets.bottom`: åº•éƒ¨å®‰å…¨åŒºåŸŸ
- `sheetHeight`: è®¡ç®—åçš„å¼¹çª—é«˜åº¦
- `paddingBottom`: å†…å®¹åŒºåŸŸçš„åº•éƒ¨å†…è¾¹è·

### ä¿®å¤ 3: ç¡®ä¿ paddingBottom æ­£ç¡®åº”ç”¨

```typescript
<View style={[styles.content, { paddingBottom: Math.max(insets.bottom, spacing.lg) }]}>
```

## ğŸ“Š è°ƒè¯•ä¿¡æ¯

ä¿®å¤åï¼Œå½“å¼¹çª—æ˜¾ç¤ºæ—¶ï¼Œä¼šè®°å½•ä»¥ä¸‹è°ƒè¯•ä¿¡æ¯åˆ°æ—¥å¿—ï¼š

```json
{
  "location": "GoogleLoginSheet:useEffect",
  "message": "Huawei adaptation debug",
  "data": {
    "screenHeight": 2340,
    "insetsBottom": 48,
    "insetsTop": 0,
    "insetsLeft": 0,
    "insetsRight": 0,
    "maxSheetHeight": 1170,
    "baseHeight": 1053,
    "minSheetHeight": 702,
    "calculatedHeight": 1122,
    "sheetHeight": 1053,
    "paddingBottom": 48
  }
}
```

## ğŸ” éªŒè¯æ­¥éª¤

1. **æŸ¥çœ‹æ—¥å¿—**ï¼šæ‰“å¼€ Google ç™»å½•å¼¹çª—ï¼ŒæŸ¥çœ‹æ—¥å¿—ä¸­çš„è°ƒè¯•ä¿¡æ¯
2. **æ£€æŸ¥ insets.bottom**ï¼šç¡®è®¤æ˜¯å¦ä¸ºåä¸º Mate 40 çš„åº•éƒ¨å¯¼èˆªæ é«˜åº¦ï¼ˆé€šå¸¸ä¸º 48-60pxï¼‰
3. **æ£€æŸ¥ sheetHeight**ï¼šç¡®è®¤æ˜¯å¦è€ƒè™‘äº† `insets.bottom`
4. **æ£€æŸ¥ paddingBottom**ï¼šç¡®è®¤å†…å®¹åŒºåŸŸæ˜¯å¦æœ‰è¶³å¤Ÿçš„åº•éƒ¨å†…è¾¹è·

## âš ï¸ æ³¨æ„äº‹é¡¹

1. **éœ€è¦é‡æ–°æ„å»º**ï¼šä¿®å¤åéœ€è¦é‡æ–°æ„å»º APK æ‰èƒ½ç”Ÿæ•ˆ
2. **è°ƒè¯•æ—¥å¿—**ï¼šä¿®å¤åå¯ä»¥é€šè¿‡æ—¥å¿—éªŒè¯é€‚é…æ˜¯å¦æ­£ç¡®
3. **æµ‹è¯•è®¾å¤‡**ï¼šå»ºè®®åœ¨åä¸º Mate 40 ä¸Šå®é™…æµ‹è¯•

## ğŸ“ ä»£ç å˜æ›´

### æ–‡ä»¶ï¼š`app/src/components/auth/GoogleLoginSheet.tsx`

1. **å¯¼å…¥ SafeAreaView**ï¼š
```typescript
import { useSafeAreaInsets, SafeAreaView } from 'react-native-safe-area-context';
```

2. **åœ¨ Modal å†…æ·»åŠ  SafeAreaView**ï¼š
```typescript
<Modal>
  <SafeAreaView style={{ flex: 1 }} edges={[]}>
    {/* åŸæœ‰å†…å®¹ */}
  </SafeAreaView>
</Modal>
```

3. **æ·»åŠ è°ƒè¯•æ—¥å¿—**ï¼š
```typescript
React.useEffect(() => {
  if (visible) {
    // è®°å½•è°ƒè¯•ä¿¡æ¯
  }
}, [visible, screenHeight, insets.bottom, sheetHeight]);
```

## ğŸš€ ä¸‹ä¸€æ­¥

1. **æµ‹è¯•ä¿®å¤**ï¼šåœ¨å¼€å‘ç¯å¢ƒæµ‹è¯•ï¼ŒæŸ¥çœ‹æ—¥å¿—
2. **éªŒè¯é€‚é…**ï¼šç¡®è®¤å¼¹çª—é«˜åº¦å’Œå†…å®¹ä½ç½®æ˜¯å¦æ­£ç¡®
3. **é‡æ–°æ„å»º**ï¼šå¦‚æœä¿®å¤æœ‰æ•ˆï¼Œé‡æ–°æ„å»º APK

