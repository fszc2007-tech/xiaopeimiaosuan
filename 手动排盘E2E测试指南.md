# æ‰‹åŠ¨æ’ç›˜ E2E æµ‹è¯•æŒ‡å—

## ğŸ“‹ æµ‹è¯•å†…å®¹

æµ‹è¯•ç”¨ä¾‹ï¼š**2025å¹´6æœˆ20æ—¥ æ—©ä¸Š8ç‚¹ å¥³ å…¬å†**

é¢„æœŸå…«å­—ç»“æœï¼š
- **å¹´æŸ±**ï¼šä¹™å·³ï¼ˆè¦†ç¯ç«ï¼‰
- **æœˆæŸ±**ï¼šå£¬åˆï¼ˆæ¨æŸ³æœ¨ï¼‰
- **æ—¥æŸ±**ï¼šåºšç”³ï¼ˆçŸ³æ¦´æœ¨ï¼‰
- **æ—¶æŸ±**ï¼šåºšè¾°ï¼ˆç™½èœ¡é‡‘ï¼‰

---

## ğŸš€ å¿«é€Ÿå¼€å§‹

### æ–¹æ³• 1ï¼šè‡ªåŠ¨åŒ–è„šæœ¬ï¼ˆæ¨èï¼‰

```bash
cd /Users/gaoxuxu/Desktop/xiaopei-app
./run-manual-bazi-test.sh
```

è¯¥è„šæœ¬ä¼šè‡ªåŠ¨æ£€æŸ¥æ‰€æœ‰ä¾èµ–å¹¶è¿è¡Œæµ‹è¯•ã€‚

---

## ğŸ“ æ‰‹åŠ¨è¿è¡Œæ­¥éª¤

### æ­¥éª¤ 1: å¯åŠ¨ Core æœåŠ¡

```bash
# ç»ˆç«¯ 1
cd /Users/gaoxuxu/Desktop/xiaopei-app/core
npm run dev
```

ç¡®è®¤æœåŠ¡å·²å¯åŠ¨ï¼š
```bash
curl http://10.89.148.75:3000/health
# åº”è¿”å›: {"success":true,"data":{"status":"ok",...}}
```

---

### æ­¥éª¤ 2: æ„å»º iOS åº”ç”¨ï¼ˆå¦‚æœå°šæœªæ„å»ºï¼‰

```bash
# ç»ˆç«¯ 2
cd /Users/gaoxuxu/Desktop/xiaopei-app/app
npx expo run:ios
```

ç­‰å¾…æ„å»ºå®Œæˆï¼Œåº”ç”¨ä¼šè‡ªåŠ¨åœ¨æ¨¡æ‹Ÿå™¨ä¸­å¯åŠ¨ã€‚

---

### æ­¥éª¤ 3: å¯åŠ¨ Appium Server

```bash
# ç»ˆç«¯ 3
appium server --port 4723
```

ç¡®è®¤ Appium å·²å¯åŠ¨ï¼Œåº”è¯¥çœ‹åˆ°ï¼š
```
[Appium] Welcome to Appium v2.x.x
[Appium] Appium REST http interface listener started on http://0.0.0.0:4723
```

---

### æ­¥éª¤ 4: è¿è¡Œ E2E æµ‹è¯•

```bash
# ç»ˆç«¯ 4
cd /Users/gaoxuxu/Desktop/xiaopei-app/app
npx wdio run wdio.conf.js --spec ./e2e-appium/manual-bazi.spec.js
```

---

## ğŸ“Š æµ‹è¯•æµç¨‹

æµ‹è¯•å°†è‡ªåŠ¨æ‰§è¡Œä»¥ä¸‹æ­¥éª¤ï¼š

1. âœ… **æ‰“å¼€æ‰‹åŠ¨æ’ç›˜é¡µé¢**
   - ç‚¹å‡»ã€Œå‘½ç›˜ã€Tab
   - ç‚¹å‡»ã€Œæ‰‹åŠ¨æ’ç›˜ã€æŒ‰é’®

2. âœ… **è¾“å…¥åŸºæœ¬ä¿¡æ¯**
   - å§“åï¼šæµ‹è¯•å¥³å‘½
   - æ€§åˆ«ï¼šå¥³

3. âœ… **è¾“å…¥å‡ºç”Ÿæ—¥æœŸ**
   - å¹´ä»½ï¼š2025
   - æœˆä»½ï¼š6æœˆ
   - æ—¥æœŸï¼š20æ—¥

4. âœ… **è¾“å…¥å‡ºç”Ÿæ—¶é—´**
   - å°æ—¶ï¼š8
   - åˆ†é’Ÿï¼š0

5. âœ… **é€‰æ‹©å†æ³•**
   - å†æ³•ï¼šå…¬å†

6. âœ… **æäº¤å¹¶è®¡ç®—**
   - ç‚¹å‡»æäº¤æŒ‰é’®
   - ç­‰å¾…è®¡ç®—å®Œæˆ

7. âœ… **éªŒè¯ç»“æœ**
   - å¹´æŸ±ï¼šä¹™å·³
   - æœˆæŸ±ï¼šå£¬åˆ
   - æ—¥æŸ±ï¼šåºšç”³
   - æ—¶æŸ±ï¼šåºšè¾°

---

## ğŸ“ æµ‹è¯•æ–‡ä»¶

### æµ‹è¯•è„šæœ¬
- **ä½ç½®**: `/Users/gaoxuxu/Desktop/xiaopei-app/app/e2e-appium/manual-bazi.spec.js`
- **åŠŸèƒ½**: å®Œæ•´çš„æ‰‹åŠ¨æ’ç›˜æµç¨‹æµ‹è¯•
- **æµ‹è¯•æ•°æ®**: 2025å¹´6æœˆ20æ—¥ æ—©ä¸Š8ç‚¹ å¥³ å…¬å†

### è¿è¡Œè„šæœ¬
- **ä½ç½®**: `/Users/gaoxuxu/Desktop/xiaopei-app/run-manual-bazi-test.sh`
- **åŠŸèƒ½**: è‡ªåŠ¨æ£€æŸ¥ä¾èµ–å¹¶è¿è¡Œæµ‹è¯•

### é…ç½®æ–‡ä»¶
- **ä½ç½®**: `/Users/gaoxuxu/Desktop/xiaopei-app/app/wdio.conf.js`
- **åŠŸèƒ½**: WebdriverIO é…ç½®

---

## âš ï¸ å¸¸è§é—®é¢˜

### 1. "Appium Server æœªè¿è¡Œ"

**è§£å†³æ–¹æ¡ˆ**:
```bash
appium server --port 4723
```

### 2. "Core æœåŠ¡æœªè¿è¡Œ"

**è§£å†³æ–¹æ¡ˆ**:
```bash
cd /Users/gaoxuxu/Desktop/xiaopei-app/core
npm run dev
```

### 3. "åº”ç”¨æœªæ„å»º"

**è§£å†³æ–¹æ¡ˆ**:
```bash
cd /Users/gaoxuxu/Desktop/xiaopei-app/app
npx expo run:ios
```

### 4. "æ‰¾ä¸åˆ°å…ƒç´ "

**å¯èƒ½åŸå› **:
- åº”ç”¨å¯èƒ½éœ€è¦å…ˆç™»å½•
- testID å¯èƒ½éœ€è¦æ›´æ–°
- å…ƒç´ å®šä½å¯èƒ½éœ€è¦è°ƒæ•´

**è§£å†³æ–¹æ¡ˆ**:
1. ç¡®ä¿åº”ç”¨å·²ç™»å½•
2. æ£€æŸ¥ ManualBaziScreen ä¸­çš„ testID
3. æŸ¥çœ‹æµ‹è¯•æ—¥å¿—ä¸­çš„è¯¦ç»†é”™è¯¯ä¿¡æ¯

### 5. "ä¼šè¯åˆ›å»ºå¤±è´¥"

**è§£å†³æ–¹æ¡ˆ**:
1. é‡å¯ Appium Server
2. æ¸…ç† WebDriverAgent ç¼“å­˜:
```bash
rm -rf ~/Library/Developer/Xcode/DerivedData
```
3. é‡æ–°æ„å»ºåº”ç”¨

---

## ğŸ”§ ä¿®æ”¹æµ‹è¯•æ•°æ®

å¦‚æœè¦æµ‹è¯•å…¶ä»–å‡ºç”Ÿæ—¥æœŸï¼Œç¼–è¾‘æµ‹è¯•è„šæœ¬ï¼š

```javascript
// æ–‡ä»¶: app/e2e-appium/manual-bazi.spec.js

// ä¿®æ”¹è¿™äº›å€¼ï¼š
await nameInput.setValue('æµ‹è¯•å¥³å‘½');  // å§“å
await femaleOption.click();            // æ€§åˆ«
const year2025 = await driver.$('~year-2025');  // å¹´ä»½
const month6 = await driver.$('~month-6');      // æœˆä»½
const day20 = await driver.$('~day-20');        // æ—¥æœŸ
const hour8 = await driver.$('~hour-8');        // å°æ—¶
const minute0 = await driver.$('~minute-0');    // åˆ†é’Ÿ
```

---

## ğŸ“ˆ æµ‹è¯•æŠ¥å‘Š

æµ‹è¯•å®Œæˆåä¼šæ˜¾ç¤ºï¼š

```
========================================
ğŸ‰ æ‰‹åŠ¨æ’ç›˜ E2E æµ‹è¯•å®Œæˆï¼
========================================
æµ‹è¯•æ•°æ®: 2025å¹´6æœˆ20æ—¥ æ—©ä¸Š8ç‚¹ å¥³ å…¬å†
é¢„æœŸç»“æœ: ä¹™å·³å¹´ å£¬åˆæœˆ åºšç”³æ—¥ åºšè¾°æ—¶
========================================

âœ… 8 ä¸ªæµ‹è¯•ç”¨ä¾‹é€šè¿‡
âŒ 0 ä¸ªæµ‹è¯•ç”¨ä¾‹å¤±è´¥
â±  æ€»è€—æ—¶: XXç§’
```

---

## ğŸ¯ ä¸‹ä¸€æ­¥

1. âœ… è¿è¡Œæµ‹è¯•éªŒè¯åŠŸèƒ½æ­£å¸¸
2. âœ… æŸ¥çœ‹æµ‹è¯•æŠ¥å‘Š
3. âœ… å¦‚æœ‰å¤±è´¥ï¼ŒæŸ¥çœ‹è¯¦ç»†æ—¥å¿—
4. âœ… ä¿®å¤é—®é¢˜å¹¶é‡æ–°æµ‹è¯•

---

**æ³¨æ„**: é¦–æ¬¡è¿è¡Œå¯èƒ½éœ€è¦è¾ƒé•¿æ—¶é—´ï¼Œå› ä¸ºéœ€è¦å¯åŠ¨æ¨¡æ‹Ÿå™¨å’Œæ„å»º WebDriverAgentã€‚

